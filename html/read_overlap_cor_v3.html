
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>read_overlap_cor_v3</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-12-02"><meta name="DC.source" content="read_overlap_cor_v3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">INPUTS</a></li><li><a href="#3">read all files with a final overlap correction output</a></li><li><a href="#4">load overlap correction and scaling in cfg file</a></li><li><a href="#5">select set of overlap functions to analyse</a></li><li><a href="#6">plot relative difference between corrected and uncorrected signal</a></li><li><a href="#7">plot all overlap functions</a></li><li><a href="#8">Scatter Plot: interior T vs. Diff w.r.t. to Lufft</a></li><li><a href="#9">Plots function of time 3D</a></li><li><a href="#10">plot at 4 altitudes</a></li><li><a href="#11">Fit Relative difference according to temperature</a></li><li><a href="#12">plot relative difference model</a></li><li><a href="#13">Test model on long term (overlap functions)</a></li><li><a href="#14">Test model on long term (relative difference w.r.t to set of well-trusted functions)</a></li><li><a href="#15">Load test data</a></li><li><a href="#16">calculate RCS and grad(RCS) with the model</a></li><li><a href="#17">Calculate PBL with simple code</a></li><li><a href="#18">Plot</a></li></ul></div><pre class="codeinput"><span class="comment">%Read Overlap Corrections</span>
clear <span class="string">variables</span>;clc;close <span class="string">all</span>;
</pre><h2>INPUTS<a name="2"></a></h2><pre class="codeinput">info.start_day  = 1;
info.start_month= 2;
info.start_year = 2013;

info.end_day  =  25;
info.end_month=  11;
info.end_year =  2014;

info.chm=<span class="string">'CHM120106'</span>;
info.tub=<span class="string">'TUB120011'</span>;

station=<span class="string">'pay'</span>;

use_local_data = 0;<span class="comment">%{0,1};</span>
corrections_to_analyze = <span class="string">'all'</span>;<span class="comment">%{'all','good_enough','well_trusted'};</span>

<span class="keyword">if</span> use_local_data
    folder_corrections=<span class="string">'C:\AllData\SharedData_Maxime\py\'</span>;
    folder_ncdata=<span class="string">'C:\AllData\'</span>;
    folder_ov_ref=<span class="string">'M:\pay-home\pay\users\poy\My Documents\workYP\lib_overlap\'</span>;
    folder_results_algo = <span class="string">'C:\AllData\SharedData_Maxime\py\'</span>;
<span class="keyword">else</span>
    folder_corrections = <span class="string">'\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\'</span>;
    folder_ncdata = <span class="string">'\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\'</span>;
    folder_ov_ref = <span class="string">'\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\overlap_functions_Lufft\'</span>;
    folder_results_algo = <span class="string">'\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\'</span>;
<span class="keyword">end</span>

[results_flag,results_time] = xlsread([folder_results_algo <span class="string">'results_automatic_algo_paper.xlsx'</span>],1,<span class="string">'A2:B755'</span>);
results_time = datenum(results_time,<span class="string">'dd.mm.yyyy'</span>);

ind_dates_nodata = results_flag==-2;
ind_dates_nodetection = results_flag==-1;
ind_dates_badquality = results_flag==0;
ind_dates_acceptablequality = results_flag==1;
ind_dates_goodquality = results_flag==2;
ind_dates_verygoodquality = results_flag==3;

list_dates_nodetection = cellstr(datestr(results_time(ind_dates_nodetection),<span class="string">'yyyymmdd'</span>));
list_dates_badquality = cellstr(datestr(results_time(ind_dates_badquality),<span class="string">'yyyymmdd'</span>));<span class="comment">% not better than Lufft</span>
list_dates_acceptablequality = cellstr(datestr(results_time(ind_dates_acceptablequality),<span class="string">'yyyymmdd'</span>));
list_dates_goodquality = cellstr(datestr(results_time(ind_dates_goodquality),<span class="string">'yyyymmdd'</span>));
list_dates_verygoodquality = cellstr(datestr(results_time(ind_dates_verygoodquality),<span class="string">'yyyymmdd'</span>));

<span class="comment">% list_dates_outliers_temperature = {'20130406','20130601','20140306','20140607','20140608','20140811','20140925'};</span>
list_dates_outliers_temperature = {<span class="string">'20130316'</span>,<span class="string">'20130512'</span>,<span class="string">'20130523'</span>,<span class="string">'20130601'</span>,<span class="string">'20130605'</span>,<span class="string">'20130627'</span>,<span class="string">'20130630'</span>,<span class="string">'20130725'</span>,<span class="keyword">...</span>
    <span class="string">'20130727'</span>,<span class="string">'20130728'</span>,<span class="string">'20130906'</span>,<span class="string">'20131229'</span>,<span class="string">'20140306'</span>,<span class="string">'20140313'</span>,<span class="string">'20140214'</span>,<span class="string">'20140324'</span>,<span class="string">'20140325'</span>,<span class="string">'20140327'</span>,<span class="keyword">...</span>
    <span class="string">'20140417'</span>,<span class="string">'20140522'</span>,<span class="string">'20140811'</span>,<span class="string">'20140823'</span>,<span class="string">'20140925'</span>};

min_nb_good_samples_after_outliers_removal  = 10;
</pre><h2>read all files with a final overlap correction output<a name="3"></a></h2><pre class="codeinput">time_vec=datenum(info.start_year,info.start_month,info.start_day):datenum(info.end_year,info.end_month,info.end_day);
k=1;
time0 = [];
quality0 = [];
nb_candidates0 = [];
overlap_cor0 = [];
temp_mean0 = [];
voltage_PM_mean0 = [];
<span class="keyword">for</span> t=1:length(time_vec)

    file=[<span class="string">'result_ovp_fc_'</span> info.chm info.tub <span class="string">'_'</span> datestr(time_vec(t),<span class="string">'yyyymmdd'</span>) <span class="string">'.mat'</span>];
    folder_day=[folder_corrections datestr(time_vec(t),<span class="string">'yyyy/mm/'</span>)];

    <span class="keyword">if</span> exist([folder_day file],<span class="string">'file'</span>)&gt;0

        disp([folder_day file]);

        load([folder_day file],<span class="string">'result'</span>);
        <span class="keyword">if</span> isempty(result.index_final) || length(result.index_final)&lt;min_nb_good_samples_after_outliers_removal
            <span class="keyword">continue</span>;
        <span class="keyword">end</span>
        overlap_cor0(k,:)=nanmedian(result.ovp_fc(:,result.index_final),2)';
        time0(k)=time_vec(t);

        <span class="comment">% Get quality</span>
        <span class="keyword">if</span> any(strcmp(list_dates_badquality,datestr(time_vec(t),<span class="string">'yyyymmdd'</span>)))
        	quality0(k) = 0;
        <span class="keyword">end</span>
        <span class="keyword">if</span> any(strcmp(list_dates_acceptablequality,datestr(time_vec(t),<span class="string">'yyyymmdd'</span>)))
            quality0(k) = 1;
        <span class="keyword">end</span>
        <span class="keyword">if</span> any(strcmp(list_dates_goodquality,datestr(time_vec(t),<span class="string">'yyyymmdd'</span>)))
            quality0(k) = 2;
        <span class="keyword">end</span>
        <span class="keyword">if</span> any(strcmp(list_dates_verygoodquality,datestr(time_vec(t),<span class="string">'yyyymmdd'</span>)))
            quality0(k) = 3;
        <span class="keyword">end</span>
        <span class="comment">% Get total number of candidates that passed the fit tests</span>
        nb_candidates0(k) = size(result.ovp_fc,2);

        <span class="comment">% Get temperature</span>
        station_str = station;
        <span class="keyword">if</span> strcmp(station,<span class="string">'pay'</span>)
            <span class="keyword">if</span> time_vec(t)&lt;=datenum(2013,2,11)
                station_str = <span class="string">'NN'</span>;
            <span class="keyword">elseif</span> time_vec(t)&lt;=datenum(2013,6,13)
                station_str = <span class="string">'payerne'</span>;
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        file=[datestr(time_vec(t),<span class="string">'yyyymmdd'</span>) <span class="string">'_'</span> station_str <span class="string">'_'</span> info.chm <span class="string">'_000.nc'</span>];
        folder_day=[folder_ncdata datestr(time_vec(t),<span class="string">'yyyy/mm/'</span>) ] ;

        disp([folder_day file])

        <span class="comment">%convert scale factor</span>
        scale_factor = ncreadatt([folder_day file],<span class="string">'temp_int'</span>,<span class="string">'scale_factor'</span>);
        <span class="keyword">if</span>(~isnumeric(scale_factor))
            ncwriteatt([folder_day file],<span class="string">'temp_int'</span>,<span class="string">'scale_factor'</span>,1./str2num(scale_factor));
        <span class="keyword">end</span>

        temp_int = ncread([folder_day file],<span class="string">'temp_int'</span>);
        nn1 = ncread([folder_day file],<span class="string">'nn1'</span>);
        time_nc = datenum(1904,1,1)+ncread([folder_day file],<span class="string">'time'</span>)/3600/24;
        temp_tmp = NaN(length(result.index_final),1);
        voltage_tmp = NaN(length(result.index_final),1);
        range = ncread([folder_day file],<span class="string">'range'</span>);
        <span class="keyword">for</span> i=1:length(result.index_final)
            indt = time_nc&gt;=result.time_start(result.index_final(i)) &amp; time_nc&lt;=result.time_end(result.index_final(i));
            temp_tmp(i) = nanmean(temp_int(indt));
            voltage_tmp(i) = nanmean(nn1(indt));
        <span class="keyword">end</span>

<span class="comment">%         temp_mean(k)=mean(ncread([folder_day file],'temp_int'));</span>
<span class="comment">%         voltage_PM_mean(k)=mean(ncread([folder_day file],'nn1'));</span>
        temp_mean0(k)=nanmedian(temp_tmp);
        voltage_PM_mean0(k)=nanmedian(voltage_tmp);

        k=k+1;

    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><pre class="codeoutput">\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/03/result_ovp_fc_CHM120106TUB120011_20130315.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/03/result_ovp_fc_CHM120106TUB120011_20130316.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/03/20130316_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/03/result_ovp_fc_CHM120106TUB120011_20130319.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/03/result_ovp_fc_CHM120106TUB120011_20130321.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/03/result_ovp_fc_CHM120106TUB120011_20130323.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130403.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130404.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130406.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/04/20130406_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130407.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130410.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130413.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130416.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/04/20130416_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130417.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/04/20130417_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130418.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/04/20130418_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130423.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/04/20130423_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/04/result_ovp_fc_CHM120106TUB120011_20130424.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/04/20130424_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130505.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/05/20130505_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130506.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130507.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130510.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/05/20130510_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130511.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130512.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/05/20130512_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130513.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/05/20130513_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130514.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/05/20130514_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130518.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130523.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/05/20130523_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130527.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130528.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130529.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/05/result_ovp_fc_CHM120106TUB120011_20130530.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130601.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130601_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130602.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130602_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130603.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130603_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130604.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130604_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130605.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130605_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130606.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130606_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130607.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130609.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130611.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130611_payerne_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130615.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130615_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130616.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130617.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130617_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130618.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130618_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130620.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130621.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130622.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130622_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130623.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130624.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130625.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130625_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130626.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130626_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130627.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130627_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130628.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130628_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/06/result_ovp_fc_CHM120106TUB120011_20130630.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/06/20130630_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130702.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130702_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130704.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130705.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130705_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130706.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130706_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130707.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130707_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130708.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130708_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130709.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130710.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130710_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130711.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130711_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130712.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130712_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130713.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130713_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130714.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130714_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130715.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130715_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130716.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130716_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130717.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130717_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130719.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130719_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130720.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130721.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130721_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130722.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130723.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130724.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130725.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130725_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130726.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130726_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130727.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130727_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130728.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130728_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130730.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130730_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/07/result_ovp_fc_CHM120106TUB120011_20130731.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/07/20130731_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130801.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130803.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130803_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130804.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130804_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130805.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130806.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130806_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130809.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130809_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130810.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130811.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130811_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130812.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130812_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130813.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130813_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130814.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130814_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130815.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130816.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130817.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130817_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130818.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130818_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130819.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130819_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130820.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130820_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130822.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130823.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130823_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130825.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130825_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130826.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130829.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130829_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130830.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130830_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/08/result_ovp_fc_CHM120106TUB120011_20130831.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/08/20130831_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130901.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/09/20130901_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130906.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/09/20130906_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130909.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130910.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/09/20130910_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130911.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130912.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130916.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130918.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130919.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130920.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130925.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/09/result_ovp_fc_CHM120106TUB120011_20130926.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/09/20130926_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/10/result_ovp_fc_CHM120106TUB120011_20131010.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/10/result_ovp_fc_CHM120106TUB120011_20131017.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/10/result_ovp_fc_CHM120106TUB120011_20131029.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/10/result_ovp_fc_CHM120106TUB120011_20131030.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/11/result_ovp_fc_CHM120106TUB120011_20131103.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/11/result_ovp_fc_CHM120106TUB120011_20131111.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/11/result_ovp_fc_CHM120106TUB120011_20131125.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/11/result_ovp_fc_CHM120106TUB120011_20131127.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/11/20131127_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/12/result_ovp_fc_CHM120106TUB120011_20131206.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/12/20131206_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2013/12/result_ovp_fc_CHM120106TUB120011_20131229.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2013/12/20131229_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/01/result_ovp_fc_CHM120106TUB120011_20140105.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/01/result_ovp_fc_CHM120106TUB120011_20140109.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/01/result_ovp_fc_CHM120106TUB120011_20140111.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/01/result_ovp_fc_CHM120106TUB120011_20140124.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/01/result_ovp_fc_CHM120106TUB120011_20140126.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/01/20140126_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/01/result_ovp_fc_CHM120106TUB120011_20140127.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/02/result_ovp_fc_CHM120106TUB120011_20140206.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/02/result_ovp_fc_CHM120106TUB120011_20140209.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/02/20140209_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/02/result_ovp_fc_CHM120106TUB120011_20140214.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/02/20140214_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/02/result_ovp_fc_CHM120106TUB120011_20140218.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/02/result_ovp_fc_CHM120106TUB120011_20140219.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/02/result_ovp_fc_CHM120106TUB120011_20140221.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/02/20140221_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140306.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140306_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140308.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140308_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140310.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140311.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140311_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140313.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140313_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140315.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140316.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140316_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140318.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140318_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140319.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140319_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140323.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140323_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140324.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140324_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140325.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140325_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140327.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140327_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/03/result_ovp_fc_CHM120106TUB120011_20140331.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/03/20140331_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140401.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140401_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140403.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140404.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140404_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140405.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140405_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140406.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140406_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140407.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140408.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140408_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140409.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140409_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140411.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140412.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140412_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140413.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140413_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140414.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140414_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140415.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140415_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140416.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140416_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140417.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140417_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140423.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140423_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140424.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/04/20140424_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140425.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/04/result_ovp_fc_CHM120106TUB120011_20140427.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140504.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140504_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140505.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140506.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140507.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140508.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140510.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140510_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140511.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140515.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140516.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140516_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140517.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140518.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140518_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140519.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140521.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140522.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140522_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140523.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140524.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140524_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140525.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140526.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140527.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140528.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140529.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140530.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/05/result_ovp_fc_CHM120106TUB120011_20140531.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/05/20140531_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140601.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140601_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140602.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140602_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140603.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140604.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140605.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140607.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140607_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140608.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140608_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140609.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140609_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140610.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140610_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140611.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140611_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140612.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140612_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140613.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140613_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140614.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140614_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140615.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140615_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140616.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140616_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140617.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140617_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140618.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140619.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140619_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140620.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140620_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140621.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140621_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140622.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140624.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140625.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140625_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140626.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140626_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140627.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140627_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140628.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/06/result_ovp_fc_CHM120106TUB120011_20140630.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/06/20140630_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140701.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/07/20140701_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140703.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140714.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140715.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/07/20140715_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140716.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140718.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140720.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140723.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/07/20140723_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140724.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/07/20140724_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140725.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140727.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/07/20140727_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140730.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/07/result_ovp_fc_CHM120106TUB120011_20140731.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/07/20140731_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140801.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140802.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140804.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140804_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140805.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140805_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140806.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140807.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140811.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140811_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140812.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140814.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140816.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140817.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140817_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140818.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140818_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140819.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140820.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140820_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140821.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140821_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140822.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140822_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140823.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140823_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140824.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/08/20140824_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140826.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140827.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140830.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/08/result_ovp_fc_CHM120106TUB120011_20140831.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140901.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140902.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/09/20140902_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140905.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140906.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/09/20140906_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140907.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140910.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140911.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/09/20140911_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140914.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140915.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140916.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140920.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140921.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140922.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/09/20140922_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140923.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/09/20140923_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/09/result_ovp_fc_CHM120106TUB120011_20140925.mat
\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\2014/09/20140925_pay_CHM120106_000.nc
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/10/result_ovp_fc_CHM120106TUB120011_20141002.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/10/result_ovp_fc_CHM120106TUB120011_20141003.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/10/result_ovp_fc_CHM120106TUB120011_20141006.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/10/result_ovp_fc_CHM120106TUB120011_20141020.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/10/result_ovp_fc_CHM120106TUB120011_20141023.mat
\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\2014/11/result_ovp_fc_CHM120106TUB120011_20141113.mat
</pre><h2>load overlap correction and scaling in cfg file<a name="4"></a></h2><pre class="codeinput">list = dir([folder_ov_ref,info.tub,<span class="string">'_*.cfg'</span>]);
<span class="keyword">if</span> isempty(list)
    error(<span class="string">'missing overlap function'</span>);
    overlap_ref = NaN(1024,1);
<span class="keyword">else</span>
    <span class="comment">%file='M:\pay-data\data\pay\PBL4EMPA\overlap_correction\overlap_functions_Lufft\overlap_ref_TUB120011_20121112_1024.cfg';</span>
    file=[folder_ov_ref list(1).name];
    fid=fopen(file);
    disp(file);
    data=textscan(fid,<span class="string">'%f'</span>,<span class="string">'delimiter'</span>,<span class="string">'\t'</span>,<span class="string">'headerlines'</span>,1);
    overlap_ref=data{1};
<span class="keyword">end</span>
</pre><pre class="codeoutput">\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\overlap_functions_Lufft\TUB120011_20121112_1024.cfg
</pre><h2>select set of overlap functions to analyse<a name="5"></a></h2><pre class="codeinput"><span class="comment">% all</span>
index_all = 1:length(time0);

<span class="comment">% all, without bad quality and without T outliers</span>
index_good_enough=[];
<span class="keyword">for</span> i=1:length(time0)
    <span class="keyword">if</span> ~any(strcmp(list_dates_badquality,datestr(time0(i),<span class="string">'yyyymmdd'</span>))) &amp;&amp; ~any(strcmp(list_dates_outliers_temperature,datestr(time0(i),<span class="string">'yyyymmdd'</span>)))
        index_good_enough(end+1)=i;
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">% only well-trusted (very good quality and not T outliers)</span>
index_well_trusted=[];
<span class="keyword">for</span> i=1:length(time0)
    <span class="keyword">if</span> any(strcmp(list_dates_verygoodquality,datestr(time0(i),<span class="string">'yyyymmdd'</span>))) &amp;&amp; ~any(strcmp(list_dates_outliers_temperature,datestr(time0(i),<span class="string">'yyyymmdd'</span>)))
        index_well_trusted(end+1)=i;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">if</span> strcmp(corrections_to_analyze,<span class="string">'all'</span>)
    index_of_interest = index_all;
<span class="keyword">elseif</span> strcmp(corrections_to_analyze,<span class="string">'good_enough'</span>)
    index_of_interest = index_good_enough;
<span class="keyword">elseif</span> strcmp(corrections_to_analyze,<span class="string">'well_trusted'</span>)
    index_of_interest = index_well_trusted;
<span class="keyword">else</span>
    error(<span class="string">'please specify which corrections to analyse'</span>)
<span class="keyword">end</span>

time = time0(index_of_interest);
quality = quality0(index_of_interest);
nb_candidates = nb_candidates0(index_of_interest);
overlap_cor = overlap_cor0(index_of_interest,:);
temp_mean = temp_mean0(index_of_interest);
voltage_PM_mean = voltage_PM_mean0(index_of_interest);

<span class="comment">% % disp which are very good but T outliers</span>
<span class="comment">% for i=1:length(time0)</span>
<span class="comment">%     if any(strcmp(list_dates_verygoodquality,datestr(time0(i),'yyyymmdd'))) &amp;&amp; any(strcmp(list_dates_outliers_temperature,datestr(time0(i),'yyyymmdd')))</span>
<span class="comment">%         disp(datestr(time0(i),'yyyymmdd'));</span>
<span class="comment">%         disp(temp_mean(i)-273.15);</span>
<span class="comment">%     end</span>
<span class="comment">% end</span>
</pre><h2>plot relative difference between corrected and uncorrected signal<a name="6"></a></h2><pre class="codeinput">figure

T = temp_mean-273.15;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,<span class="string">'DefaultAxesColorOrder'</span>,RGB)

hold <span class="string">on</span>

relative_difference=NaN(length(time),length(range));
<span class="keyword">for</span> i=1:length(time)
    relative_difference(i,:)=(-1./overlap_ref'+1./overlap_cor(i,:))./(1./overlap_ref')*100;
    h=scatter(relative_difference(i,:),range,<span class="keyword">...</span>
        ones(size(overlap_cor(i,:)))*12,repmat(temp_mean(i)-273.15,size(overlap_cor(i,:))),<span class="keyword">...</span>
        <span class="string">'filled'</span>,<span class="string">'displayname'</span>,datestr(time(i)));
    hp = plot(relative_difference(i,:),range,<span class="string">'displayname'</span>,datestr(time(i)));

<span class="keyword">end</span>
hc = colorbar;
<span class="comment">% ylabel(hc,'mean interior T during the day [&deg;C]');</span>
ylabel(hc,<span class="string">'median interior T during calculation of overlap correction [&deg;C]'</span>);

ylim([0,1200])
set(gca,<span class="string">'ytick'</span>,0:200:1200)
xlabel({<span class="string">'Relative Difference between'</span>;<span class="string">'corrected and uncorrected signal [%]'</span> })
ylabel(<span class="string">'Range [m]'</span>)
colormap(jet)
xlim([-80 20]);
caxis([15 40]);
grid <span class="string">on</span>
box <span class="string">on</span>
</pre><pre class="codeoutput error">Error using matlab.ui.Figure/set
This is not a valid ColorOrder value. The input value must be a valid number

Error in read_overlap_cor_v3 (line 209)
set(gcf,'DefaultAxesColorOrder',RGB)
</pre><h2>plot all overlap functions<a name="7"></a></h2><pre class="codeinput">figure;

T = temp_mean-273.15;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,<span class="string">'DefaultAxesColorOrder'</span>,RGB)

hold <span class="string">on</span>;
<span class="keyword">for</span> i=1:length(time)
<span class="comment">%     plot(range,overlap_cor(i,:),'color',0.5*ones(1,3),'displayname',datestr(time(i)));</span>
    plot(range,overlap_cor(i,:),<span class="string">'displayname'</span>,datestr(time(i)));
<span class="keyword">end</span>
hc = colorbar;
<span class="comment">% ylabel(hc,'mean interior T during the day [&deg;C]');</span>
ylabel(hc,<span class="string">'median interior T during calculation of overlap correction [&deg;C]'</span>);
caxis([15,40]);
colormap(jet);
plot(range,overlap_ref,<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2)
patcher(range',nanmin(overlap_cor,[],1),nanmax(overlap_cor,[],1),0.25*ones(1,3),[],<span class="string">'FaceAlpha'</span>,0.25);

ylim([0 1.2]);
xlim([0 1200]);
set(gca,<span class="string">'xtick'</span>,0:200:1200)
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Range [m]'</span>)
title(<span class="string">'All corrected overlap functions'</span>)
</pre><h2>Scatter Plot: interior T vs. Diff w.r.t. to Lufft<a name="8"></a></h2><pre class="codeinput">ti = time;
T = temp_mean;
ov_cor = overlap_cor;
ov = overlap_ref;
disp_text = false;

a = T-273.15;
<span class="comment">%l2-norm</span>
b = 100*sqrt(trapz(abs(ov_cor'-repmat(ov,1,length(ti))).^2)) ./ sqrt(trapz(abs(repmat(ov,1,length(ti))).^2));
<span class="comment">%linf-norm</span>
<span class="comment">% b = 100*max(abs(ov_cor'-repmat(ov,1,length(ti))),[],1) ./ max(abs(repmat(ov,1,length(ti))),[],1);</span>


p = polyfit(a,b,1);

SStot = sum((b'-repmat(mean(b),length(b),1)).^2);
SSres = sum((b'-polyval(p,a')).^2);
R2 = 1-SSres/SStot;
RMSE = sqrt(SSres/length(a));
RMSErel = 100*RMSE / sqrt(sum(polyval(p,a').^2)/length(a));
<span class="comment">% disp(['Rsquared of the fit: ' num2str(R2)])</span>
<span class="comment">% disp(['RMSE of the fit: ' num2str(RMSE)])</span>

fz = 18;
hf=figure(<span class="string">'Units'</span>,<span class="string">'Normalized'</span>,<span class="string">'Position'</span>,[0 0 1 1],<span class="string">'Visible'</span>,<span class="string">'on'</span>);
scatter(a,b,<span class="string">'filled'</span>);<span class="comment">% scatter(a,b,36,jet(length(a)),'filled')</span>
<span class="keyword">if</span> disp_text
    hold <span class="string">on</span>;
    <span class="keyword">for</span> j=1:length(ti)
        text(a(j),b(j),datestr(ti(j),<span class="string">'dd.mm.yyyy HH:MM'</span>),<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="string">'FontSize'</span>,8);
    <span class="keyword">end</span>
<span class="keyword">end</span>
xlim([15 40]);
axis <span class="string">equal</span>;
h_fit = line(xlim,polyval(p,xlim),<span class="string">'Color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
<span class="comment">% h_out = line(xlim,polyval([p(1) p(2)+0.35],xlim),'Color','k','LineStyle','--');</span>
<span class="comment">% h_out = line(xlim,polyval([p(1) p(2)-0.35],xlim),'Color','k','LineStyle','--');</span>
<span class="comment">% h_out = line(xlim,polyval([p(1) p(2)+3.5],xlim),'Color','k','LineStyle','--');</span>
<span class="comment">% h_out = line(xlim,polyval([p(1) p(2)-3.5],xlim),'Color','k','LineStyle','--');</span>

<span class="comment">% xlabel('mean interior T during the day [&deg;C]','FontSize',fz);</span>
xlabel(<span class="string">'median interior T during calculation of overlap correction [&deg;C]'</span>,<span class="string">'FontSize'</span>,fz);

ylabel(<span class="string">'|ov_{corrected} - ov_{manufacturer}|_l^2 / |ov_{manufacturer}|_l^2 (%)'</span>,<span class="string">'FontSize'</span>,fz);
<span class="comment">% ylabel('|ov_{corrected} - ov_{manufacturer}|_{l^{\infty}} / |ov_{manufacturer}|_{l^{\infty}} (%)','FontSize',fz);</span>
ylim([0 5]);
<span class="comment">% ylim([0 25]);</span>


grid <span class="string">on</span>;

<span class="comment">% legend(h_fit,['poly1+-0.35, R^2=' num2str(R2) ', rel. RMSE=' num2str(RMSErel) '%']);</span>
<span class="comment">% legend(h_fit,['poly1+-3.5, R^2=' num2str(R2) ', rel. RMSE=' num2str(RMSErel) '%']);</span>
legend(h_fit,[<span class="string">'R^2='</span> num2str(R2) <span class="string">', RMSE='</span> num2str(RMSE)]);

set(gca,<span class="string">'FontSize'</span>,fz);
set(gcf,<span class="string">'PaperPositionMode'</span>,<span class="string">'auto'</span>);
</pre><h2>Plots function of time 3D<a name="9"></a></h2><pre class="codeinput">ov = overlap_ref;
[X,Y] = meshgrid(time-datenum(2000,1,1),x);

figure;
surf(X,Y,overlap_cor'-repmat(ov,1,length(time)),repmat(temp_mean-273.15,length(x),1));
<span class="comment">% surf(X,Y,overlap_cor',repmat(temp_mean-273.15,length(x),1));</span>
hold <span class="string">on</span>

Ov_350=interp2(X,Y,overlap_cor'-repmat(ov,1,length(time)),time-datenum(2000,1,1),350*ones(size(time)));
OV_350_interped=interp1(time,Ov_350,floor(min(time)):max(time));
OV_350_smoothed=smooth(floor(min(time)):max(time),OV_350_interped,90);
plot3((floor(min(time)):max(time))-datenum(2000,1,1),350*ones(size(floor(min(time)):max(time))),OV_350_smoothed,<span class="string">'r'</span>,<span class="string">'linewidth'</span>,2)

colorbar;
ylim([0 1200])
xlabel(<span class="string">'Day'</span>)
ylabel(<span class="string">'Range [m]'</span>)
zlabel(<span class="string">'ov\_corrected - ov\_manufacturer'</span>);
datetick(<span class="string">'x'</span>,<span class="string">'mm/yy'</span>)
</pre><h2>plot at 4 altitudes<a name="10"></a></h2><pre class="codeinput">altitudes = [250,350,450,550,650];

figure;
list_plots = [];
list_legends = {};
hold <span class="string">on</span>;
colors = hsv(length(altitudes));
<span class="keyword">for</span> j=1:length(altitudes)
    [~,ind] = nanmin(abs(range-altitudes(j)));
<span class="comment">%     list_plots(end+1) = plot(time,overlap_cor(:,ind),'.-');</span>
    y = (-1./overlap_ref(ind)'+1./overlap_cor(:,ind))./(1./overlap_ref(ind)')*100;
    list_plots(end+1) = plot(time,y,<span class="string">'o'</span>,<span class="string">'Color'</span>,colors(j,:),<span class="string">'MarkerFaceColor'</span>,colors(j,:));
    list_legends{end+1} = [<span class="string">'r='</span> num2str(range(ind),<span class="string">'%2.0f'</span>) <span class="string">'m'</span>];
    hold <span class="string">on</span>;
    plot(time,smooth(y,11),<span class="string">'-'</span>,<span class="string">'Color'</span>,colors(j,:),<span class="string">'linewidth'</span>,2);
<span class="keyword">end</span>
legend(list_plots,list_legends);
set(gca,<span class="string">'xtick'</span>,datenum(2013,1:24,1,00,00,00));
set(gca,<span class="string">'xlim'</span>,[datenum(2013,4,1),datenum(2014,10,1)]);
box <span class="string">on</span>;grid <span class="string">on</span>;datetick(<span class="string">'x'</span>,<span class="string">'mm/yy'</span>,<span class="string">'keepticks'</span>,<span class="string">'keeplimits'</span>);
ylim([-40 40]);
ylabel({<span class="string">'Relative difference between'</span>;<span class="string">'corrected and uncorrected signal [%]'</span> })
xlabel(<span class="string">'month/year'</span>);
</pre><h2>Fit Relative difference according to temperature<a name="11"></a></h2><pre class="codeinput">a = zeros(size(range));
b = zeros(size(range));
c = zeros(size(range));
r2 = zeros(size(range));
rmse = zeros(size(range));

<span class="comment">% figure('nextplot','replacechildren');</span>
<span class="keyword">for</span> j=1:find(range&lt;=1200,1,<span class="string">'last'</span>)
        val = overlap_cor(:,j);
        val(val&lt;=0) = eps;
        rel_diff = (-1./overlap_ref(j)+1./val)./(1./overlap_ref(j))*100;

        y_fit = rel_diff;
        x_fit = temp_mean(:)-273.15;

        x_fit = x_fit(~isnan(y_fit) &amp; ~isinf(y_fit));
        y_fit = y_fit(~isnan(y_fit) &amp; ~isinf(y_fit));

        dT = 1;
        [counts,centers] = hist(x_fit,15:dT:40);
        weights = zeros(length(counts),1);
        weights(counts&gt;0) = max(counts)./counts(counts&gt;0);
        weights_fit = zeros(length(x_fit),1);
        <span class="keyword">for</span> l=1:length(centers)
            indx = x_fit&gt;centers(l)-dT/2 &amp; x_fit&lt;=centers(l)+dT/2;
            weights_fit(indx) = weights(l).^1;
        <span class="keyword">end</span>

<span class="comment">%         [fo,gof] = fit(x_fit,y_fit,'poly2','Robust','Bisquare');</span>
<span class="comment">%         a(j) = fo.p1(1);</span>
<span class="comment">%         b(j) = fo.p2(1);</span>
<span class="comment">%         c(j) = fo.p3(1);</span>

        [fo,gof] = fit(x_fit,y_fit,<span class="string">'poly1'</span>);
<span class="comment">%         [fo,gof] = fit(x_fit,y_fit,'poly1','Robust','Bisquare');</span>
<span class="comment">%         [fo,gof] = fit(x_fit,y_fit,'poly1','Robust','Bisquare','Weights',weights_fit);</span>
        a(j) = 0;
        b(j) = fo.p1(1);
        c(j) = fo.p2(1);
        r2(j) = gof.rsquare;
        rmse(j) = gof.rmse;

<span class="comment">%         scatter(x_fit,y_fit,'filled');grid on;box on;line([0 40],feval(fo,[0 40]),'color','k','linewidth',2);</span>
<span class="comment">%         xlim([0 40]);xlabel('T [&deg;C]');</span>
<span class="comment">% %         ylim([-80 10]);</span>
<span class="comment">%         ylabel({'Relative difference between';'corrected and uncorrected signal [%]'})</span>
<span class="comment">%         title(['r=' num2str(range(j),'%2.0f') 'm']);</span>
<span class="comment">%         pause;</span>
<span class="keyword">end</span>

temp_vector = 15:0.1:40;
color_vector=jet(length(temp_vector));

figure;

T = temp_vector;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,<span class="string">'DefaultAxesColorOrder'</span>,RGB)

hold <span class="string">on</span>
ov_reconstructed=ones(length(temp_vector),length(range));
<span class="keyword">for</span> i=1:length(temp_vector)
    temp_of_interest=temp_vector(i);
    <span class="keyword">for</span> j=1:length(range)
        rel_diff = polyval([a(j),b(j),c(j)],temp_of_interest);
        ov_reconstructed(i,j) = 1./ (rel_diff/100/overlap_ref(j) + 1./overlap_ref(j));
    <span class="keyword">end</span>
    plot(range,ov_reconstructed(i,:),<span class="string">'color'</span>,color_vector(i,:));
<span class="keyword">end</span>

hc = colorbar;
ylabel(hc,<span class="string">'interior T [&deg;C]'</span>);
colormap(<span class="string">'jet'</span>);
caxis([15 40])

h_ref = plot(range,overlap_ref,<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2);
ylim([0 1.2]);
xlim([0 1200]);
set(gca,<span class="string">'xtick'</span>,0:200:1200)
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Range [m]'</span>)
ylabel(<span class="string">'Overlap function'</span>);
title([<span class="string">'Temperature model, T='</span> num2str(temp_vector(1)) <span class="string">'...'</span> num2str(temp_vector(end)) <span class="string">'[&deg;C]'</span>]);

legend(h_ref,[info.chm info.tub]);
</pre><h2>plot relative difference model<a name="12"></a></h2><pre class="codeinput">temp_vector = 15:0.1:40;
color_vector=jet(length(temp_vector));
figure
hold <span class="string">on</span>
ov_reconstructed=ones(length(temp_vector),length(range));
<span class="keyword">for</span> i=1:length(temp_vector)
    rel_diff = NaN(length(range),1);
    <span class="keyword">for</span> j=1:length(range)
        rel_diff(j) = polyval([a(j),b(j),c(j)],temp_vector(i));
    <span class="keyword">end</span>

    rel_diff(range&lt;=range(find(b&gt;0 &amp; range &lt;range(find(overlap_ref&lt;0.01,1,<span class="string">'last'</span>)),1,<span class="string">'last'</span>))) = NaN;

    h=scatter(rel_diff,range,<span class="keyword">...</span>
        ones(length(range),1)*0,repmat(temp_vector(i),length(range),1),<span class="keyword">...</span>
        <span class="string">'filled'</span>,<span class="string">'displayname'</span>,num2str(temp_vector(i)));
    h=plot(rel_diff,range,<span class="string">'color'</span>,color_vector(i,:));

<span class="keyword">end</span>
hc = colorbar;
ylabel(hc,<span class="string">'interior T [&deg;C]'</span>);

ylim([0,1200])
set(gca,<span class="string">'ytick'</span>,0:200:1200)
xlabel({<span class="string">'Relative Difference between'</span>;<span class="string">'corrected (with model) and uncorrected signal [%]'</span> })
ylabel(<span class="string">'Range [m]'</span>)
colormap(jet)
xlim([-80 20]);
grid <span class="string">on</span>
box <span class="string">on</span>
</pre><h2>Test model on long term (overlap functions)<a name="13"></a></h2><pre class="codeinput">figure;

T = temp_mean-273.15;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,<span class="string">'DefaultAxesColorOrder'</span>,RGB)

subplot(1,2,1)
hold <span class="string">on</span>

subplot(1,2,2)
hold <span class="string">on</span>

subplot(1,2,2)
hold <span class="string">on</span>
ov_reconstructed2=ones(length(time),length(range));

<span class="comment">% colorvec=jet(length(time));</span>
<span class="keyword">for</span> i=1:length(time)
    temp_of_interest=temp_mean(i)-273.15;
    <span class="keyword">for</span> j=1:length(range)
        rel_diff = polyval([a(j),b(j),c(j)],temp_of_interest);
        ov_reconstructed2(i,j) = 1./ (rel_diff/100/overlap_ref(j) + 1./overlap_ref(j));
    <span class="keyword">end</span>
    subplot(1,2,1)
    title(<span class="string">'corrections'</span>)
<span class="comment">%     plot(range,overlap_cor(i,:),'color',colorvec(i,:),'displayname',datestr(time(i)));</span>
    plot(range,overlap_cor(i,:),<span class="string">'displayname'</span>,datestr(time(i)));
    subplot(1,2,2)
    title(<span class="string">'model'</span>)
<span class="comment">%     plot(range,ov_reconstructed2(i,:),'color',colorvec(i,:));</span>
    plot(range,ov_reconstructed2(i,:));

<span class="keyword">end</span>

subplot(1,2,1)
plot(range,overlap_ref,<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2)
ylim([0 1.2]);
xlim([0 1200]);
set(gca,<span class="string">'xtick'</span>,0:200:1200);
colormap(<span class="string">'jet'</span>);
caxis([15,40]);
hc = colorbar;
<span class="comment">% ylabel(hc,'mean interior T during the day [&deg;C]');</span>
ylabel(hc,<span class="string">'median interior T during calculation of overlap correction [&deg;C]'</span>);
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Range [m]'</span>)

subplot(1,2,2)
plot(range,overlap_ref,<span class="string">'--k'</span>,<span class="string">'LineWidth'</span>,2)
ylim([0 1.2]);
xlim([0 1200]);
set(gca,<span class="string">'xtick'</span>,0:200:1200);
colormap(<span class="string">'jet'</span>);
caxis([15,40]);
hc = colorbar;
ylabel(hc,<span class="string">'interior T [&deg;C]'</span>);
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Range [m]'</span>)
</pre><h2>Test model on long term (relative difference w.r.t to set of well-trusted functions)<a name="14"></a></h2><pre class="codeinput">xlims = [-60 60];
ylabel_str = <span class="string">'Range [m]'</span>;
ylims = [0 1200];
index_range_for_stats = overlap_ref&gt;0.005 &amp; overlap_ref&lt;1;

figure;
subplot(2,3,1)
hold <span class="string">on</span>

subplot(2,3,2)
hold <span class="string">on</span>

subplot(2,3,3)
hold <span class="string">on</span>

subplot(2,3,4)
hold <span class="string">on</span>

subplot(2,3,5)
hold <span class="string">on</span>

subplot(2,3,6)
hold <span class="string">on</span>


ov_reconstructed=ones(length(time),length(range));

rel_diff_all1=zeros(length(time),length(range));
rel_diff_all2=zeros(length(time),length(range));
rel_diff_all3=zeros(length(time),length(range));
rel_diff_all4=zeros(length(time),length(range));
rel_diff_all5=zeros(length(time),length(range));
rel_diff_all6=zeros(length(time),length(range));

<span class="comment">% consider only well-trusted corrections</span>
index = index_well_trusted;

T = temp_mean(index);
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,<span class="string">'DefaultAxesColorOrder'</span>,RGB)


<span class="comment">% colorvec=jet(length(index));</span>
colorvec=RGB;
<span class="keyword">for</span> i=1:length(index)


    subplot(2,3,1)

    <span class="comment">%calculate relative difference with Lufft reference</span>
    rel_diff_all1(index(i),:) = (-1./overlap_ref'+1./overlap_cor(index(i),:))./(1./overlap_ref')*100;
    plot(rel_diff_all1(index(i),:),range,<span class="string">'color'</span>,colorvec(i,:),<span class="string">'displayname'</span>,datestr(time(index(i))));
    xlabel_rel_diff_all1 = {<span class="string">'Relative difference'</span>;<span class="string">'With Lufft reference'</span>};


    subplot(2,3,2)

    <span class="comment">%recalculate relative difference with temperature model</span>
    temp_of_interest=temp_mean(index(i))-273.15;
    <span class="keyword">for</span> j=1:length(range)
        rel_diff = polyval([a(j),b(j),c(j)],temp_of_interest);
        ov_reconstructed(index(i),j) = 1./ (rel_diff/100/overlap_ref(j) + 1./overlap_ref(j));
    <span class="keyword">end</span>
    rel_diff_all2(index(i),:) = (-1./ov_reconstructed(index(i),:)+1./overlap_cor(index(i),:))./(1./ov_reconstructed(index(i),:))*100;
    plot(rel_diff_all2(index(i),:),range,<span class="string">'color'</span>,colorvec(i,:),<span class="string">'displayname'</span>,datestr(time(index(i))));
    xlabel_rel_diff_all2 = {<span class="string">'Relative difference'</span>;<span class="string">'With Temperature model'</span>};


    subplot(2,3,3)

    <span class="comment">%recalculate relative difference with last well-trusted overlap</span>
    <span class="keyword">if</span> i&gt;1
        rel_diff_all3(index(i),:) = (-1./overlap_cor(index(i-1),:)+1./overlap_cor(index(i),:))./(1./overlap_cor(index(i-1),:))*100;
        plot(rel_diff_all3(index(i),:),range,<span class="string">'color'</span>,colorvec(i,:),<span class="string">'displayname'</span>,datestr(time(index(i))));
        xlabel_rel_diff_all3 = {<span class="string">'Relative difference'</span>;<span class="string">'With last well-trusted overlap function'</span>};
    <span class="keyword">end</span>


    subplot(2,3,4)

    <span class="comment">%recalculate relative difference with overlap correction of closest temperature</span>
    index_all = 1:length(index);
    index_all_short = index_all(~(i==(1:length(index))));
    [~,index_min]= min(abs(temp_mean(index(index_all_short))-temp_mean(index(i))));
    rel_diff_all4(index(i),:) = (-1./overlap_cor(index(index_all_short(index_min)),:)+1./overlap_cor(index(i),:))./(1./overlap_cor(index(index_all_short(index_min)),:))*100;
    xlabel_rel_diff_all4 = {<span class="string">'Relative difference'</span>;<span class="string">'With well-trusted overlap function of closest Temperature'</span>};
    plot(rel_diff_all4(index(i),:),range,<span class="string">'color'</span>,colorvec(i,:),<span class="string">'displayname'</span>,datestr(time(index(i))));


    subplot(2,3,5)

    <span class="comment">%recalculate relative difference with overlap correction of closest time</span>
    index_all = 1:length(index);
    index_all_short = index_all(~(i==(1:length(index))));
    [~,index_min]= min(abs(time(index(index_all_short))-time(index(i))));
    rel_diff_all5(index(i),:) = (-1./overlap_cor(index(index_all_short(index_min)),:)+1./overlap_cor(index(i),:))./(1./overlap_cor(index(index_all_short(index_min)),:))*100;
    xlabel_rel_diff_all5 = {<span class="string">'Relative difference'</span>;<span class="string">'With well-trusted overlap function of closest time'</span>};
    plot(rel_diff_all5(index(i),:),range,<span class="string">'color'</span>,colorvec(i,:),<span class="string">'displayname'</span>,datestr(time(index(i))));


    subplot(2,3,6)

    <span class="comment">%recalculate relative difference with corrected overlap of specific date</span>
    i_dateofinterest = find(time==datenum(2014,06,16));
    <span class="keyword">if</span> isempty(i_dateofinterest)
        error(<span class="string">'date of interest not found'</span>)
    <span class="keyword">end</span>
    rel_diff_all6(index(i),:) = (-1./overlap_cor(i_dateofinterest,:)+1./overlap_cor(index(i),:))./(1./overlap_cor(i_dateofinterest,:))*100;
    xlabel_rel_diff_all6 = {<span class="string">'Relative difference'</span>;[<span class="string">'With well-trusted overlap of '</span> datestr(time(i_dateofinterest))]};
    plot(rel_diff_all6(index(i),:),range,<span class="string">'color'</span>,colorvec(i,:),<span class="string">'displayname'</span>,datestr(time(index(i))));

<span class="keyword">end</span>


subplot(2,3,1)
hold <span class="string">on</span>;
plot(median(rel_diff_all1(index,:)),range,<span class="string">'-k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all1(index,:),25),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all1(index,:),75),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
ylim(ylims);
grid <span class="string">on</span>;box <span class="string">on</span>;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all1);
hold <span class="string">on</span>;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
plot(xlims,max(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
RMSE=sqrt(1/numel(rel_diff_all1(index,index_range_for_stats)) *nansum(nansum(rel_diff_all1(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all1(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all1(index,index_range_for_stats),75)-prctile(rel_diff_all1(index,index_range_for_stats),25));
title([<span class="string">'RMSE='</span> num2str(RMSE) <span class="string">',MEANmedian='</span> num2str(MEANmedian) <span class="string">',MEANiqr='</span> num2str(MEANiqr)]);
colormap(<span class="string">'jet'</span>);
caxis([15 40]);

subplot(2,3,2)
plot(median(rel_diff_all2(index,:)),range,<span class="string">'-k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all2(index,:),25),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all2(index,:),75),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
ylim(ylims);
grid <span class="string">on</span>;box <span class="string">on</span>;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all2)
hold <span class="string">on</span>;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
plot(xlims,max(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
RMSE=sqrt(1/numel(rel_diff_all2(index,index_range_for_stats)) *nansum(nansum(rel_diff_all2(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all2(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all2(index,index_range_for_stats),75)-prctile(rel_diff_all2(index,index_range_for_stats),25));
title([<span class="string">'RMSE='</span> num2str(RMSE) <span class="string">',MEANmedian='</span> num2str(MEANmedian) <span class="string">',MEANiqr='</span> num2str(MEANiqr)]);
colormap(<span class="string">'jet'</span>);
caxis([15 40]);

subplot(2,3,3)
plot(median(rel_diff_all3(index,:)),range,<span class="string">'-k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all3(index,:),25),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all3(index,:),75),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
ylim(ylims);
grid <span class="string">on</span>;box <span class="string">on</span>;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all3)
hold <span class="string">on</span>;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
plot(xlims,max(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
RMSE=sqrt(1/numel(rel_diff_all3(index,index_range_for_stats)) *nansum(nansum(rel_diff_all3(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all3(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all3(index,index_range_for_stats),75)-prctile(rel_diff_all3(index,index_range_for_stats),25));
title([<span class="string">'RMSE='</span> num2str(RMSE) <span class="string">',MEANmedian='</span> num2str(MEANmedian) <span class="string">',MEANiqr='</span> num2str(MEANiqr)]);
colormap(<span class="string">'jet'</span>);
caxis([15 40]);

subplot(2,3,4)
plot(median(rel_diff_all4(index,:)),range,<span class="string">'-k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all4(index,:),25),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all4(index,:),75),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
ylim(ylims);
grid <span class="string">on</span>;box <span class="string">on</span>;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all4)
hold <span class="string">on</span>;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
plot(xlims,max(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
RMSE=sqrt(1/numel(rel_diff_all4(index,index_range_for_stats)) *nansum(nansum(rel_diff_all4(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all4(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all4(index,index_range_for_stats),75)-prctile(rel_diff_all4(index,index_range_for_stats),25));
title([<span class="string">'RMSE='</span> num2str(RMSE) <span class="string">',MEANmedian='</span> num2str(MEANmedian) <span class="string">',MEANiqr='</span> num2str(MEANiqr)]);
colormap(<span class="string">'jet'</span>);
caxis([15 40]);

subplot(2,3,5)
plot(median(rel_diff_all5(index,:)),range,<span class="string">'-k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all5(index,:),25),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all5(index,:),75),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
ylim(ylims);
grid <span class="string">on</span>;box <span class="string">on</span>;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all5)
hold <span class="string">on</span>;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
plot(xlims,max(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
RMSE=sqrt(1/numel(rel_diff_all5(index,index_range_for_stats)) *nansum(nansum(rel_diff_all5(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all5(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all5(index,index_range_for_stats),75)-prctile(rel_diff_all5(index,index_range_for_stats),25));
title([<span class="string">'RMSE='</span> num2str(RMSE) <span class="string">',MEANmedian='</span> num2str(MEANmedian) <span class="string">',MEANiqr='</span> num2str(MEANiqr)]);
colormap(<span class="string">'jet'</span>);
caxis([15 40]);

subplot(2,3,6)
plot(median(rel_diff_all6(index,:)),range,<span class="string">'-k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all6(index,:),25),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
plot(prctile(rel_diff_all6(index,:),75),range,<span class="string">'--k'</span>,<span class="string">'linewidth'</span>,2)
ylim(ylims);
grid <span class="string">on</span>;box <span class="string">on</span>;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all6)
hold <span class="string">on</span>;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
plot(xlims,max(range(index_range_for_stats))*ones(1,2),<span class="string">'--k'</span>);
RMSE=sqrt(1/numel(rel_diff_all6(index,index_range_for_stats)) *nansum(nansum(rel_diff_all6(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all6(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all6(index,index_range_for_stats),75)-prctile(rel_diff_all6(index,index_range_for_stats),25));
title([<span class="string">'RMSE='</span> num2str(RMSE) <span class="string">',MEANmedian='</span> num2str(MEANmedian) <span class="string">',MEANiqr='</span> num2str(MEANiqr)]);
colormap(<span class="string">'jet'</span>);
caxis([15 40]);

<span class="comment">% return</span>
</pre><h2>Load test data<a name="15"></a></h2><pre class="codeinput"><span class="comment">% date = '20130417';</span>
date = <span class="string">'20140614'</span>;

[chm,chminfo] = get_chm15k_from_files(<span class="string">'pay'</span>,[date,<span class="string">'000000'</span>],datestr(datenum(date,<span class="string">'yyyymmdd'</span>)+1,<span class="string">'yyyymmddHHMMSS'</span>),folder_ncdata);
<span class="comment">% [chm,chminfo]=readcorrectlyncfile3('pay',date,folder_ncdata);</span>

RCS_raw = chm.beta_raw;
RCS_dailycorrection = chm.beta_raw./repmat(overlap_cor(find(time==datenum(date,<span class="string">'yyyymmdd'</span>)),:)',1,size(chm.beta_raw,2)).*repmat(overlap_ref,1,size(chm.beta_raw,2));

<span class="comment">% Calc Grad</span>
grad_raw = NaN(size(RCS_raw));
<span class="keyword">for</span> j=1:length(chm.time)
    grad_raw(:,j) = 1/(2*chm.range_gate)*conv(RCS_raw(:,j),[1 0 -1],<span class="string">'same'</span>);
<span class="keyword">end</span>
grad_dailycorrection = NaN(size(RCS_dailycorrection));
<span class="keyword">for</span> j=1:length(chm.time)
    grad_dailycorrection(:,j) = 1/(2*chm.range_gate)*conv(RCS_dailycorrection(:,j),[1 0 -1],<span class="string">'same'</span>);
<span class="keyword">end</span>

<span class="comment">% plot internal temperature</span>
figure;
plot(chm.time,chm.temp_int-273.15);datetick;ylim([15 40]);box <span class="string">on</span>;grid <span class="string">on</span>;
xlabel(<span class="string">'Time [UT]'</span>);ylabel(<span class="string">'Internal Temperature [&deg;C]'</span>);title([<span class="string">'pay '</span> date]);
</pre><h2>calculate RCS and grad(RCS) with the model<a name="16"></a></h2><pre class="codeinput"><span class="comment">%correct according to T</span>

ind_last_as_reference = find(b&gt;0 &amp; range &lt;range(find(overlap_ref&lt;0.01,1,<span class="string">'last'</span>)),1,<span class="string">'last'</span>);
<span class="keyword">if</span> ~isempty(ind_last_as_reference)
    a(range&lt;=range(ind_last_as_reference)) = 0;
    c(range&lt;=range(ind_last_as_reference)) = 0;
    b(range&lt;=range(ind_last_as_reference)) = 0;
<span class="keyword">end</span>

ov_rec_all = NaN(size(RCS_raw));
<span class="keyword">for</span> i=1:find(chm.range&lt;=1200,1,<span class="string">'last'</span>)
    rel_diff = polyval([a(i),b(i),c(i)],chm.temp_int-273.15);
    ov_rec_all(i,:) = 1./ (rel_diff/100/overlap_ref(i) + 1./overlap_ref(i));
<span class="keyword">end</span>
ov_rec_all(find(chm.range&lt;=1200,1,<span class="string">'last'</span>)+1:end,:) = repmat(overlap_ref(find(chm.range&lt;=1200,1,<span class="string">'last'</span>)+1:end),1,size(RCS_raw,2));

RCS_corr = RCS_raw./ov_rec_all.*repmat(overlap_ref,1,size(RCS_raw,2));

<span class="comment">% Calc Grad</span>
grad_corr = NaN(size(RCS_corr));
<span class="keyword">for</span> j=1:length(chm.time)
    grad_corr(:,j) = 1/(2*chm.range_gate)*conv(RCS_corr(:,j),[1 0 -1],<span class="string">'same'</span>);
<span class="keyword">end</span>
</pre><h2>Calculate PBL with simple code<a name="17"></a></h2><pre class="codeinput">[gradients_raw,xtime] = simplePBLdetection(chm,overlap_ref,overlap_ref);
[gradients_dailycorrection,xtime] = simplePBLdetection(chm,overlap_ref,overlap_cor(find(time==datenum(date,<span class="string">'yyyymmdd'</span>)),:)');
[gradients_corr,xtime] = simplePBLdetection(chm,overlap_ref,ov_rec_all);

<span class="comment">% Plot PBL</span>
figure;

subplot(3,1,1);
gradients = gradients_raw;
correction_type = <span class="string">'raw'</span>;
list_plots = [];
list_legends = {};
hold <span class="string">on</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(5,:),<span class="string">'.'</span>,<span class="string">'color'</span>,0.5*ones(1,3));
list_legends{end+1} = <span class="string">'clouds'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(4,:),<span class="string">'.k'</span>);
list_legends{end+1} = <span class="string">'1. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(3,:),<span class="string">'.g'</span>);
list_legends{end+1} = <span class="string">'2. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(2,:),<span class="string">'.y'</span>);
list_legends{end+1} = <span class="string">'3. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(1,:),<span class="string">'.r'</span>);
list_legends{end+1} = <span class="string">'min. gradient'</span>;
legend(list_plots,list_legends,<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
ylim([0 2500]);
xlim([datenum(date,<span class="string">'yyyymmdd'</span>) datenum(date,<span class="string">'yyyymmdd'</span>)+1]);
set(gca,<span class="string">'xtick'</span>,datenum(date,<span class="string">'yyyymmdd'</span>):4/24:datenum(date,<span class="string">'yyyymmdd'</span>)+1);
datetick(<span class="string">'x'</span>,<span class="string">'HH:MM'</span>,<span class="string">'keepticks'</span>,<span class="string">'keeplimits'</span>);
title([<span class="string">'pay '</span> date <span class="string">' - '</span> correction_type]);
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Time [UT]'</span>);
ylabel(<span class="string">'Range [m]'</span>);

subplot(3,1,2);
gradients = gradients_dailycorrection;
correction_type = <span class="string">'daily correction'</span>;
list_plots = [];
list_legends = {};
hold <span class="string">on</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(5,:),<span class="string">'.'</span>,<span class="string">'color'</span>,0.5*ones(1,3));
list_legends{end+1} = <span class="string">'clouds'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(4,:),<span class="string">'.k'</span>);
list_legends{end+1} = <span class="string">'1. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(3,:),<span class="string">'.g'</span>);
list_legends{end+1} = <span class="string">'2. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(2,:),<span class="string">'.y'</span>);
list_legends{end+1} = <span class="string">'3. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(1,:),<span class="string">'.r'</span>);
list_legends{end+1} = <span class="string">'min. gradient'</span>;
legend(list_plots,list_legends,<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
ylim([0 2500]);
xlim([datenum(date,<span class="string">'yyyymmdd'</span>) datenum(date,<span class="string">'yyyymmdd'</span>)+1]);
set(gca,<span class="string">'xtick'</span>,datenum(date,<span class="string">'yyyymmdd'</span>):4/24:datenum(date,<span class="string">'yyyymmdd'</span>)+1);
datetick(<span class="string">'x'</span>,<span class="string">'HH:MM'</span>,<span class="string">'keepticks'</span>,<span class="string">'keeplimits'</span>);
title([<span class="string">'pay '</span> date <span class="string">' - '</span> correction_type]);
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Time [UT]'</span>);
ylabel(<span class="string">'Range [m]'</span>);

subplot(3,1,3);
gradients = gradients_corr;
correction_type = <span class="string">'model'</span>;
list_plots = [];
list_legends = {};
hold <span class="string">on</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(5,:),<span class="string">'.'</span>,<span class="string">'color'</span>,0.5*ones(1,3));
list_legends{end+1} = <span class="string">'clouds'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(4,:),<span class="string">'.k'</span>);
list_legends{end+1} = <span class="string">'1. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(3,:),<span class="string">'.g'</span>);
list_legends{end+1} = <span class="string">'2. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(2,:),<span class="string">'.y'</span>);
list_legends{end+1} = <span class="string">'3. strongest gradient'</span>;
list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime,gradients(1,:),<span class="string">'.r'</span>);
list_legends{end+1} = <span class="string">'min. gradient'</span>;
legend(list_plots,list_legends,<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
ylim([0 2500]);
xlim([datenum(date,<span class="string">'yyyymmdd'</span>) datenum(date,<span class="string">'yyyymmdd'</span>)+1]);
set(gca,<span class="string">'xtick'</span>,datenum(date,<span class="string">'yyyymmdd'</span>):4/24:datenum(date,<span class="string">'yyyymmdd'</span>)+1);
datetick(<span class="string">'x'</span>,<span class="string">'HH:MM'</span>,<span class="string">'keepticks'</span>,<span class="string">'keeplimits'</span>);
title([<span class="string">'pay '</span> date <span class="string">' - '</span> correction_type]);
grid <span class="string">on</span>;box <span class="string">on</span>;
xlabel(<span class="string">'Time [UT]'</span>);
ylabel(<span class="string">'Range [m]'</span>);
</pre><h2>Plot<a name="18"></a></h2><pre class="codeinput">RCS_list = {RCS_raw,RCS_dailycorrection,RCS_corr};
grad_list = {grad_raw,grad_dailycorrection,grad_corr};
gradients_list = {gradients_raw,gradients_dailycorrection,gradients_corr};
correction_type_list = {<span class="string">'raw'</span>,<span class="string">'daily correction'</span>,<span class="string">'model correction'</span>};

<span class="keyword">for</span> k=1:length(RCS_list)
    RCS = RCS_list{k};
    grad = grad_list{k};
    gradients = gradients_list{k};
    title_str = [info.chm <span class="string">'/'</span> info.tub <span class="string">'/'</span> station <span class="string">' - '</span> date <span class="string">' - '</span> correction_type_list{k}];


    offset = datenum(2000,1,1)-1;
    disp_clouds = true;
    disp_pbl = true;
    <span class="comment">% Choose pcolor parameters</span>
    dxticks = 4;<span class="comment">%in hours</span>
    fz = 14;<span class="comment">% FontSize</span>
    ylims = [0 2500];
    yticks = ylims(1):100:ylims(2);
    clims = [4.5 6];
    clims_grad = [-1000 1000];
    <span class="comment">% load('ypcmap2','cmap');</span>

    figure

    handles.axes_pcolor_RCS = subplot(2,1,1);
    handles.surface_pcolor_RCS = pcolor(chm.time-offset,chm.range,log10(abs(RCS)));
    xlims = [floor(chm.time(1))-offset, ceil(chm.time(end))-offset];
    xticks = xlims(1)-mod(mod(xlims(1),1)*24,dxticks)/24:dxticks/24:xlims(2);
    set(gca,<span class="string">'XLim'</span>,xlims,<span class="string">'XTick'</span>,xticks,<span class="string">'XMinorTick'</span>,<span class="string">'on'</span>);
    set(gca,<span class="string">'YLim'</span>,ylims,<span class="string">'YTick'</span>,yticks,<span class="string">'YMinorTick'</span>,<span class="string">'on'</span>);
    grid <span class="string">on</span>;
    set(gca,<span class="string">'Layer'</span>,<span class="string">'top'</span>);
    datetick(<span class="string">'x'</span>,<span class="string">'HH:MM'</span>,<span class="string">'keepticks'</span>,<span class="string">'keeplimits'</span>);
    shading <span class="string">flat</span>
    caxis(clims)
    <span class="comment">%     colormap(cmap)</span>
    hc = colorbar;
    xlabel(<span class="string">'Time UT [h]'</span>,<span class="string">'FontSize'</span>,fz);
    ylabel(hc,<span class="string">'log10(abs(beta\_raw))'</span>,<span class="string">'FontSize'</span>,fz);
    ylabel(<span class="string">'Range (m)'</span>,<span class="string">'FontSize'</span>,fz);
    <span class="comment">% daspect(aspect_ratio);</span>
    list_plots = [];
    list_legends = {};

    <span class="keyword">if</span>(disp_pbl)
        <span class="comment">%     for j=1:3</span>
        <span class="comment">%         pblh = chm.pbl(j,:);</span>
        <span class="comment">%         pblh(pblh &lt;= chm.cho) = NaN;</span>
        <span class="comment">%         hpbl = line(chm.time-offset,pblh-chm.cho,'LineStyle','none','Marker','.','Color','k');</span>
        <span class="comment">%     end</span>
        <span class="comment">%     list_plots(end+1) = hpbl;</span>
        <span class="comment">%     list_legends{end+1} = 'PBL';</span>
        hold <span class="string">on</span>;
        list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime-offset,gradients(4,:),<span class="string">'.k'</span>,<span class="string">'MarkerSize'</span>,16);
        list_legends{end+1} = <span class="string">'1. strongest gradient'</span>;
        list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime-offset,gradients(3,:),<span class="string">'.m'</span>,<span class="string">'MarkerSize'</span>,16);
        list_legends{end+1} = <span class="string">'2. strongest gradient'</span>;
        list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime-offset,gradients(2,:),<span class="string">'.b'</span>,<span class="string">'MarkerSize'</span>,16);
        list_legends{end+1} = <span class="string">'3. strongest gradient'</span>;
        list_plots(end+1) = plot(datenum(date,<span class="string">'yyyymmdd'</span>)+xtime-offset,gradients(1,:),<span class="string">'.r'</span>,<span class="string">'MarkerSize'</span>,16);
        list_legends{end+1} = <span class="string">'min. gradient'</span>;
    <span class="keyword">end</span>
    <span class="keyword">if</span>(disp_clouds)
        <span class="keyword">for</span> j=1:3
            cbh = chm.cbh(j,:);
            cbh(cbh &lt;= chm.cho) = NaN;
            hcbh = line(chm.time-offset,cbh-chm.cho,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Marker'</span>,<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,16,<span class="string">'Color'</span>,[0.5 0.5 0.5]);
        <span class="keyword">end</span>
        list_plots(end+1) = hcbh;
        list_legends{end+1} = <span class="string">'CBH'</span>;
    <span class="keyword">end</span>
    <span class="keyword">if</span> ~isempty(list_plots)
        legend(list_plots,list_legends,<span class="string">'Orientation'</span>,<span class="string">'horizontal'</span>);
    <span class="keyword">end</span>
    set(gca,<span class="string">'FontSize'</span>,fz);

    title(title_str,<span class="string">'FontSize'</span>,fz);

    handles.axes_pcolor_grad = subplot(2,1,2);
    handles.surface_pcolor_grad = pcolor(chm.time-offset,chm.range,grad);
    xlims = [floor(chm.time(1))-offset, ceil(chm.time(end))-offset];
    xticks = xlims(1)-mod(mod(xlims(1),1)*24,dxticks)/24:dxticks/24:xlims(2);
    set(gca,<span class="string">'XLim'</span>,xlims,<span class="string">'XTick'</span>,xticks,<span class="string">'XMinorTick'</span>,<span class="string">'on'</span>);
    set(gca,<span class="string">'YLim'</span>,ylims,<span class="string">'YTick'</span>,yticks,<span class="string">'YMinorTick'</span>,<span class="string">'on'</span>);
    grid <span class="string">on</span>;
    set(gca,<span class="string">'Layer'</span>,<span class="string">'top'</span>);
    datetick(<span class="string">'x'</span>,<span class="string">'HH:MM'</span>,<span class="string">'keepticks'</span>,<span class="string">'keeplimits'</span>);
    shading <span class="string">flat</span>
    caxis(clims_grad)
    colormap(jet)
    hc = colorbar;
    xlabel(<span class="string">'Time UT [h]'</span>,<span class="string">'FontSize'</span>,fz);
    ylabel(hc,<span class="string">'grad(beta\_raw)'</span>,<span class="string">'FontSize'</span>,fz);
    ylabel(<span class="string">'Range (m)'</span>,<span class="string">'FontSize'</span>,fz);
    <span class="comment">% daspect(aspect_ratio);</span>
    set(gca,<span class="string">'FontSize'</span>,fz);

    set(gcf,<span class="string">'PaperPositionMode'</span>,<span class="string">'auto'</span>);

<span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%Read Overlap Corrections
clear variables;clc;close all;


%% INPUTS
info.start_day  = 1;
info.start_month= 2;
info.start_year = 2013;

info.end_day  =  25;
info.end_month=  11;
info.end_year =  2014;

info.chm='CHM120106';
info.tub='TUB120011';

station='pay';

use_local_data = 0;%{0,1};
corrections_to_analyze = 'all';%{'all','good_enough','well_trusted'};

if use_local_data
    folder_corrections='C:\AllData\SharedData_Maxime\py\';
    folder_ncdata='C:\AllData\';
    folder_ov_ref='M:\pay-home\pay\users\poy\My Documents\workYP\lib_overlap\';
    folder_results_algo = 'C:\AllData\SharedData_Maxime\py\';
else
    folder_corrections = '\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\corrections\';
    folder_ncdata = '\\meteoswiss.ch\mch\pay-data\data\pay\REM\ACQ\CEILO_CHM15k\NetCDF\daily\';
    folder_ov_ref = '\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\overlap_functions_Lufft\';
    folder_results_algo = '\\meteoswiss.ch\mch\pay-data\data\pay\PBL4EMPA\overlap_correction\';
end

[results_flag,results_time] = xlsread([folder_results_algo 'results_automatic_algo_paper.xlsx'],1,'A2:B755');
results_time = datenum(results_time,'dd.mm.yyyy');

ind_dates_nodata = results_flag==-2;
ind_dates_nodetection = results_flag==-1;
ind_dates_badquality = results_flag==0;
ind_dates_acceptablequality = results_flag==1;
ind_dates_goodquality = results_flag==2;
ind_dates_verygoodquality = results_flag==3;

list_dates_nodetection = cellstr(datestr(results_time(ind_dates_nodetection),'yyyymmdd'));
list_dates_badquality = cellstr(datestr(results_time(ind_dates_badquality),'yyyymmdd'));% not better than Lufft
list_dates_acceptablequality = cellstr(datestr(results_time(ind_dates_acceptablequality),'yyyymmdd'));
list_dates_goodquality = cellstr(datestr(results_time(ind_dates_goodquality),'yyyymmdd'));
list_dates_verygoodquality = cellstr(datestr(results_time(ind_dates_verygoodquality),'yyyymmdd'));

% list_dates_outliers_temperature = {'20130406','20130601','20140306','20140607','20140608','20140811','20140925'};
list_dates_outliers_temperature = {'20130316','20130512','20130523','20130601','20130605','20130627','20130630','20130725',...
    '20130727','20130728','20130906','20131229','20140306','20140313','20140214','20140324','20140325','20140327',...
    '20140417','20140522','20140811','20140823','20140925'};

min_nb_good_samples_after_outliers_removal  = 10;


%% read all files with a final overlap correction output
time_vec=datenum(info.start_year,info.start_month,info.start_day):datenum(info.end_year,info.end_month,info.end_day);
k=1;
time0 = [];
quality0 = [];
nb_candidates0 = [];
overlap_cor0 = [];
temp_mean0 = [];
voltage_PM_mean0 = [];
for t=1:length(time_vec)

    file=['result_ovp_fc_' info.chm info.tub '_' datestr(time_vec(t),'yyyymmdd') '.mat'];
    folder_day=[folder_corrections datestr(time_vec(t),'yyyy/mm/')];
    
    if exist([folder_day file],'file')>0

        disp([folder_day file]);
        
        load([folder_day file],'result');
        if isempty(result.index_final) || length(result.index_final)<min_nb_good_samples_after_outliers_removal
            continue;
        end
        overlap_cor0(k,:)=nanmedian(result.ovp_fc(:,result.index_final),2)';
        time0(k)=time_vec(t);
        
        % Get quality
        if any(strcmp(list_dates_badquality,datestr(time_vec(t),'yyyymmdd')))
        	quality0(k) = 0;
        end
        if any(strcmp(list_dates_acceptablequality,datestr(time_vec(t),'yyyymmdd')))
            quality0(k) = 1;
        end
        if any(strcmp(list_dates_goodquality,datestr(time_vec(t),'yyyymmdd')))
            quality0(k) = 2;
        end
        if any(strcmp(list_dates_verygoodquality,datestr(time_vec(t),'yyyymmdd')))
            quality0(k) = 3;
        end
        % Get total number of candidates that passed the fit tests
        nb_candidates0(k) = size(result.ovp_fc,2);

        % Get temperature
        station_str = station;
        if strcmp(station,'pay')
            if time_vec(t)<=datenum(2013,2,11)
                station_str = 'NN';
            elseif time_vec(t)<=datenum(2013,6,13)
                station_str = 'payerne';
            end
        end
        
        file=[datestr(time_vec(t),'yyyymmdd') '_' station_str '_' info.chm '_000.nc'];
        folder_day=[folder_ncdata datestr(time_vec(t),'yyyy/mm/') ] ;
        
        disp([folder_day file])
        
        %convert scale factor
        scale_factor = ncreadatt([folder_day file],'temp_int','scale_factor');
        if(~isnumeric(scale_factor))
            ncwriteatt([folder_day file],'temp_int','scale_factor',1./str2num(scale_factor));
        end
        
        temp_int = ncread([folder_day file],'temp_int');
        nn1 = ncread([folder_day file],'nn1');
        time_nc = datenum(1904,1,1)+ncread([folder_day file],'time')/3600/24;
        temp_tmp = NaN(length(result.index_final),1);
        voltage_tmp = NaN(length(result.index_final),1);
        range = ncread([folder_day file],'range');
        for i=1:length(result.index_final)
            indt = time_nc>=result.time_start(result.index_final(i)) & time_nc<=result.time_end(result.index_final(i));
            temp_tmp(i) = nanmean(temp_int(indt));
            voltage_tmp(i) = nanmean(nn1(indt));
        end
        
%         temp_mean(k)=mean(ncread([folder_day file],'temp_int'));
%         voltage_PM_mean(k)=mean(ncread([folder_day file],'nn1'));
        temp_mean0(k)=nanmedian(temp_tmp);
        voltage_PM_mean0(k)=nanmedian(voltage_tmp);
        
        k=k+1;
        
    end
end

%% load overlap correction and scaling in cfg file
list = dir([folder_ov_ref,info.tub,'_*.cfg']);
if isempty(list)
    error('missing overlap function');
    overlap_ref = NaN(1024,1);
else
    %file='M:\pay-data\data\pay\PBL4EMPA\overlap_correction\overlap_functions_Lufft\overlap_ref_TUB120011_20121112_1024.cfg';
    file=[folder_ov_ref list(1).name];
    fid=fopen(file);
    disp(file);
    data=textscan(fid,'%f','delimiter','\t','headerlines',1);
    overlap_ref=data{1};
end

%% select set of overlap functions to analyse

% all
index_all = 1:length(time0);

% all, without bad quality and without T outliers
index_good_enough=[];
for i=1:length(time0)
    if ~any(strcmp(list_dates_badquality,datestr(time0(i),'yyyymmdd'))) && ~any(strcmp(list_dates_outliers_temperature,datestr(time0(i),'yyyymmdd')))
        index_good_enough(end+1)=i;
    end
end
% only well-trusted (very good quality and not T outliers)
index_well_trusted=[];
for i=1:length(time0)
    if any(strcmp(list_dates_verygoodquality,datestr(time0(i),'yyyymmdd'))) && ~any(strcmp(list_dates_outliers_temperature,datestr(time0(i),'yyyymmdd')))
        index_well_trusted(end+1)=i;
    end
end

if strcmp(corrections_to_analyze,'all')
    index_of_interest = index_all;
elseif strcmp(corrections_to_analyze,'good_enough')
    index_of_interest = index_good_enough;
elseif strcmp(corrections_to_analyze,'well_trusted')
    index_of_interest = index_well_trusted;
else
    error('please specify which corrections to analyse')
end

time = time0(index_of_interest);
quality = quality0(index_of_interest);
nb_candidates = nb_candidates0(index_of_interest);
overlap_cor = overlap_cor0(index_of_interest,:);
temp_mean = temp_mean0(index_of_interest);
voltage_PM_mean = voltage_PM_mean0(index_of_interest);

% % disp which are very good but T outliers
% for i=1:length(time0)
%     if any(strcmp(list_dates_verygoodquality,datestr(time0(i),'yyyymmdd'))) && any(strcmp(list_dates_outliers_temperature,datestr(time0(i),'yyyymmdd')))
%         disp(datestr(time0(i),'yyyymmdd'));
%         disp(temp_mean(i)-273.15);
%     end
% end


%% plot relative difference between corrected and uncorrected signal
figure

T = temp_mean-273.15;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,'DefaultAxesColorOrder',RGB)

hold on

relative_difference=NaN(length(time),length(range));
for i=1:length(time)
    relative_difference(i,:)=(-1./overlap_ref'+1./overlap_cor(i,:))./(1./overlap_ref')*100;
    h=scatter(relative_difference(i,:),range,...
        ones(size(overlap_cor(i,:)))*12,repmat(temp_mean(i)-273.15,size(overlap_cor(i,:))),...
        'filled','displayname',datestr(time(i)));
    hp = plot(relative_difference(i,:),range,'displayname',datestr(time(i)));
    
end
hc = colorbar;
% ylabel(hc,'mean interior T during the day [°C]');
ylabel(hc,'median interior T during calculation of overlap correction [°C]');

ylim([0,1200])
set(gca,'ytick',0:200:1200)
xlabel({'Relative Difference between';'corrected and uncorrected signal [%]' })
ylabel('Range [m]')
colormap(jet)
xlim([-80 20]);
caxis([15 40]);
grid on
box on

%% plot all overlap functions

figure;

T = temp_mean-273.15;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,'DefaultAxesColorOrder',RGB)

hold on;
for i=1:length(time)
%     plot(range,overlap_cor(i,:),'color',0.5*ones(1,3),'displayname',datestr(time(i)));
    plot(range,overlap_cor(i,:),'displayname',datestr(time(i)));
end
hc = colorbar;
% ylabel(hc,'mean interior T during the day [°C]');
ylabel(hc,'median interior T during calculation of overlap correction [°C]');
caxis([15,40]);
colormap(jet);
plot(range,overlap_ref,'REPLACE_WITH_DASH_DASHk','LineWidth',2)
patcher(range',nanmin(overlap_cor,[],1),nanmax(overlap_cor,[],1),0.25*ones(1,3),[],'FaceAlpha',0.25);

ylim([0 1.2]);
xlim([0 1200]);
set(gca,'xtick',0:200:1200)
grid on;box on;
xlabel('Range [m]')
title('All corrected overlap functions')

%% Scatter Plot: interior T vs. Diff w.r.t. to Lufft

ti = time;
T = temp_mean;
ov_cor = overlap_cor;
ov = overlap_ref;
disp_text = false;

a = T-273.15;
%l2-norm
b = 100*sqrt(trapz(abs(ov_cor'-repmat(ov,1,length(ti))).^2)) ./ sqrt(trapz(abs(repmat(ov,1,length(ti))).^2));
%linf-norm
% b = 100*max(abs(ov_cor'-repmat(ov,1,length(ti))),[],1) ./ max(abs(repmat(ov,1,length(ti))),[],1);


p = polyfit(a,b,1);

SStot = sum((b'-repmat(mean(b),length(b),1)).^2);
SSres = sum((b'-polyval(p,a')).^2);
R2 = 1-SSres/SStot;
RMSE = sqrt(SSres/length(a));
RMSErel = 100*RMSE / sqrt(sum(polyval(p,a').^2)/length(a));
% disp(['Rsquared of the fit: ' num2str(R2)])
% disp(['RMSE of the fit: ' num2str(RMSE)])

fz = 18;
hf=figure('Units','Normalized','Position',[0 0 1 1],'Visible','on');
scatter(a,b,'filled');% scatter(a,b,36,jet(length(a)),'filled')
if disp_text
    hold on;
    for j=1:length(ti)
        text(a(j),b(j),datestr(ti(j),'dd.mm.yyyy HH:MM'),'HorizontalAlignment','center','FontSize',8);
    end
end
xlim([15 40]);
axis equal;
h_fit = line(xlim,polyval(p,xlim),'Color','k','LineWidth',2,'LineStyle','REPLACE_WITH_DASH_DASH');
% h_out = line(xlim,polyval([p(1) p(2)+0.35],xlim),'Color','k','LineStyle','REPLACE_WITH_DASH_DASH');
% h_out = line(xlim,polyval([p(1) p(2)-0.35],xlim),'Color','k','LineStyle','REPLACE_WITH_DASH_DASH');
% h_out = line(xlim,polyval([p(1) p(2)+3.5],xlim),'Color','k','LineStyle','REPLACE_WITH_DASH_DASH');
% h_out = line(xlim,polyval([p(1) p(2)-3.5],xlim),'Color','k','LineStyle','REPLACE_WITH_DASH_DASH');

% xlabel('mean interior T during the day [°C]','FontSize',fz);
xlabel('median interior T during calculation of overlap correction [°C]','FontSize',fz);

ylabel('|ov_{corrected} - ov_{manufacturer}|_l^2 / |ov_{manufacturer}|_l^2 (%)','FontSize',fz);
% ylabel('|ov_{corrected} - ov_{manufacturer}|_{l^{\infty}} / |ov_{manufacturer}|_{l^{\infty}} (%)','FontSize',fz);
ylim([0 5]);
% ylim([0 25]);


grid on;

% legend(h_fit,['poly1+-0.35, R^2=' num2str(R2) ', rel. RMSE=' num2str(RMSErel) '%']);
% legend(h_fit,['poly1+-3.5, R^2=' num2str(R2) ', rel. RMSE=' num2str(RMSErel) '%']);
legend(h_fit,['R^2=' num2str(R2) ', RMSE=' num2str(RMSE)]);

set(gca,'FontSize',fz);
set(gcf,'PaperPositionMode','auto');

%% Plots function of time 3D
ov = overlap_ref;
[X,Y] = meshgrid(time-datenum(2000,1,1),x);

figure;
surf(X,Y,overlap_cor'-repmat(ov,1,length(time)),repmat(temp_mean-273.15,length(x),1));
% surf(X,Y,overlap_cor',repmat(temp_mean-273.15,length(x),1));
hold on

Ov_350=interp2(X,Y,overlap_cor'-repmat(ov,1,length(time)),time-datenum(2000,1,1),350*ones(size(time)));
OV_350_interped=interp1(time,Ov_350,floor(min(time)):max(time));
OV_350_smoothed=smooth(floor(min(time)):max(time),OV_350_interped,90);
plot3((floor(min(time)):max(time))-datenum(2000,1,1),350*ones(size(floor(min(time)):max(time))),OV_350_smoothed,'r','linewidth',2)

colorbar;
ylim([0 1200])
xlabel('Day')
ylabel('Range [m]')
zlabel('ov\_corrected - ov\_manufacturer');
datetick('x','mm/yy')

%% plot at 4 altitudes
altitudes = [250,350,450,550,650];

figure;
list_plots = [];
list_legends = {};
hold on;
colors = hsv(length(altitudes));
for j=1:length(altitudes)
    [~,ind] = nanmin(abs(range-altitudes(j)));
%     list_plots(end+1) = plot(time,overlap_cor(:,ind),'.-');
    y = (-1./overlap_ref(ind)'+1./overlap_cor(:,ind))./(1./overlap_ref(ind)')*100;
    list_plots(end+1) = plot(time,y,'o','Color',colors(j,:),'MarkerFaceColor',colors(j,:));
    list_legends{end+1} = ['r=' num2str(range(ind),'%2.0f') 'm'];
    hold on;
    plot(time,smooth(y,11),'-','Color',colors(j,:),'linewidth',2);
end
legend(list_plots,list_legends);
set(gca,'xtick',datenum(2013,1:24,1,00,00,00));
set(gca,'xlim',[datenum(2013,4,1),datenum(2014,10,1)]);
box on;grid on;datetick('x','mm/yy','keepticks','keeplimits');
ylim([-40 40]);
ylabel({'Relative difference between';'corrected and uncorrected signal [%]' })
xlabel('month/year');


%% Fit Relative difference according to temperature
a = zeros(size(range));
b = zeros(size(range));
c = zeros(size(range));
r2 = zeros(size(range));
rmse = zeros(size(range));

% figure('nextplot','replacechildren');
for j=1:find(range<=1200,1,'last')
        val = overlap_cor(:,j);
        val(val<=0) = eps;
        rel_diff = (-1./overlap_ref(j)+1./val)./(1./overlap_ref(j))*100;
        
        y_fit = rel_diff;
        x_fit = temp_mean(:)-273.15;
        
        x_fit = x_fit(~isnan(y_fit) & ~isinf(y_fit));
        y_fit = y_fit(~isnan(y_fit) & ~isinf(y_fit));
        
        dT = 1;
        [counts,centers] = hist(x_fit,15:dT:40);
        weights = zeros(length(counts),1);
        weights(counts>0) = max(counts)./counts(counts>0);
        weights_fit = zeros(length(x_fit),1);
        for l=1:length(centers)
            indx = x_fit>centers(l)-dT/2 & x_fit<=centers(l)+dT/2;
            weights_fit(indx) = weights(l).^1;
        end

%         [fo,gof] = fit(x_fit,y_fit,'poly2','Robust','Bisquare');
%         a(j) = fo.p1(1);
%         b(j) = fo.p2(1);
%         c(j) = fo.p3(1);

        [fo,gof] = fit(x_fit,y_fit,'poly1');
%         [fo,gof] = fit(x_fit,y_fit,'poly1','Robust','Bisquare');
%         [fo,gof] = fit(x_fit,y_fit,'poly1','Robust','Bisquare','Weights',weights_fit);
        a(j) = 0;
        b(j) = fo.p1(1);
        c(j) = fo.p2(1);
        r2(j) = gof.rsquare;
        rmse(j) = gof.rmse;
        
%         scatter(x_fit,y_fit,'filled');grid on;box on;line([0 40],feval(fo,[0 40]),'color','k','linewidth',2);
%         xlim([0 40]);xlabel('T [°C]');
% %         ylim([-80 10]);
%         ylabel({'Relative difference between';'corrected and uncorrected signal [%]'})
%         title(['r=' num2str(range(j),'%2.0f') 'm']);
%         pause;
end

temp_vector = 15:0.1:40;
color_vector=jet(length(temp_vector));

figure;

T = temp_vector;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,'DefaultAxesColorOrder',RGB)

hold on
ov_reconstructed=ones(length(temp_vector),length(range));
for i=1:length(temp_vector)
    temp_of_interest=temp_vector(i);
    for j=1:length(range)
        rel_diff = polyval([a(j),b(j),c(j)],temp_of_interest);
        ov_reconstructed(i,j) = 1./ (rel_diff/100/overlap_ref(j) + 1./overlap_ref(j));
    end
    plot(range,ov_reconstructed(i,:),'color',color_vector(i,:));
end

hc = colorbar;
ylabel(hc,'interior T [°C]');
colormap('jet');
caxis([15 40])

h_ref = plot(range,overlap_ref,'REPLACE_WITH_DASH_DASHk','LineWidth',2);
ylim([0 1.2]);
xlim([0 1200]);
set(gca,'xtick',0:200:1200)
grid on;box on;
xlabel('Range [m]')
ylabel('Overlap function');
title(['Temperature model, T=' num2str(temp_vector(1)) '...' num2str(temp_vector(end)) '[°C]']);

legend(h_ref,[info.chm info.tub]);

%% plot relative difference model
temp_vector = 15:0.1:40;
color_vector=jet(length(temp_vector));
figure
hold on
ov_reconstructed=ones(length(temp_vector),length(range));
for i=1:length(temp_vector)
    rel_diff = NaN(length(range),1);
    for j=1:length(range)
        rel_diff(j) = polyval([a(j),b(j),c(j)],temp_vector(i));
    end
    
    rel_diff(range<=range(find(b>0 & range <range(find(overlap_ref<0.01,1,'last')),1,'last'))) = NaN;
    
    h=scatter(rel_diff,range,...
        ones(length(range),1)*0,repmat(temp_vector(i),length(range),1),...
        'filled','displayname',num2str(temp_vector(i)));
    h=plot(rel_diff,range,'color',color_vector(i,:));
    
end
hc = colorbar;
ylabel(hc,'interior T [°C]');

ylim([0,1200])
set(gca,'ytick',0:200:1200)
xlabel({'Relative Difference between';'corrected (with model) and uncorrected signal [%]' })
ylabel('Range [m]')
colormap(jet)
xlim([-80 20]);
grid on
box on

%% Test model on long term (overlap functions)
figure;

T = temp_mean-273.15;
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,'DefaultAxesColorOrder',RGB)

subplot(1,2,1)
hold on

subplot(1,2,2)
hold on

subplot(1,2,2)
hold on
ov_reconstructed2=ones(length(time),length(range));

% colorvec=jet(length(time));
for i=1:length(time)
    temp_of_interest=temp_mean(i)-273.15;
    for j=1:length(range)
        rel_diff = polyval([a(j),b(j),c(j)],temp_of_interest);
        ov_reconstructed2(i,j) = 1./ (rel_diff/100/overlap_ref(j) + 1./overlap_ref(j));
    end
    subplot(1,2,1)
    title('corrections')
%     plot(range,overlap_cor(i,:),'color',colorvec(i,:),'displayname',datestr(time(i)));
    plot(range,overlap_cor(i,:),'displayname',datestr(time(i)));
    subplot(1,2,2)
    title('model')
%     plot(range,ov_reconstructed2(i,:),'color',colorvec(i,:));
    plot(range,ov_reconstructed2(i,:));
  
end

subplot(1,2,1)
plot(range,overlap_ref,'REPLACE_WITH_DASH_DASHk','LineWidth',2)
ylim([0 1.2]);
xlim([0 1200]);
set(gca,'xtick',0:200:1200);
colormap('jet');
caxis([15,40]);
hc = colorbar;
% ylabel(hc,'mean interior T during the day [°C]');
ylabel(hc,'median interior T during calculation of overlap correction [°C]');
grid on;box on;
xlabel('Range [m]')

subplot(1,2,2)
plot(range,overlap_ref,'REPLACE_WITH_DASH_DASHk','LineWidth',2)
ylim([0 1.2]);
xlim([0 1200]);
set(gca,'xtick',0:200:1200);
colormap('jet');
caxis([15,40]);
hc = colorbar;
ylabel(hc,'interior T [°C]');
grid on;box on;
xlabel('Range [m]')

%% Test model on long term (relative difference w.r.t to set of well-trusted functions)

xlims = [-60 60];
ylabel_str = 'Range [m]';
ylims = [0 1200];
index_range_for_stats = overlap_ref>0.005 & overlap_ref<1;

figure;
subplot(2,3,1)
hold on

subplot(2,3,2)
hold on

subplot(2,3,3)
hold on

subplot(2,3,4)
hold on

subplot(2,3,5)
hold on

subplot(2,3,6)
hold on


ov_reconstructed=ones(length(time),length(range));

rel_diff_all1=zeros(length(time),length(range));
rel_diff_all2=zeros(length(time),length(range));
rel_diff_all3=zeros(length(time),length(range));
rel_diff_all4=zeros(length(time),length(range));
rel_diff_all5=zeros(length(time),length(range));
rel_diff_all6=zeros(length(time),length(range));

% consider only well-trusted corrections
index = index_well_trusted;

T = temp_mean(index);
Treduced = (T-min(T))/(max(T)-min(T))*(length(jet)-1)+1;
RGB = interp1(1:length(jet),jet,Treduced);

set(gcf,'DefaultAxesColorOrder',RGB)


% colorvec=jet(length(index));
colorvec=RGB;
for i=1:length(index)
    
    
    subplot(2,3,1)
    
    %calculate relative difference with Lufft reference
    rel_diff_all1(index(i),:) = (-1./overlap_ref'+1./overlap_cor(index(i),:))./(1./overlap_ref')*100;
    plot(rel_diff_all1(index(i),:),range,'color',colorvec(i,:),'displayname',datestr(time(index(i))));
    xlabel_rel_diff_all1 = {'Relative difference';'With Lufft reference'};
    
    
    subplot(2,3,2)
    
    %recalculate relative difference with temperature model
    temp_of_interest=temp_mean(index(i))-273.15;
    for j=1:length(range)
        rel_diff = polyval([a(j),b(j),c(j)],temp_of_interest);
        ov_reconstructed(index(i),j) = 1./ (rel_diff/100/overlap_ref(j) + 1./overlap_ref(j));
    end
    rel_diff_all2(index(i),:) = (-1./ov_reconstructed(index(i),:)+1./overlap_cor(index(i),:))./(1./ov_reconstructed(index(i),:))*100;
    plot(rel_diff_all2(index(i),:),range,'color',colorvec(i,:),'displayname',datestr(time(index(i))));
    xlabel_rel_diff_all2 = {'Relative difference';'With Temperature model'};
    
    
    subplot(2,3,3)
    
    %recalculate relative difference with last well-trusted overlap
    if i>1
        rel_diff_all3(index(i),:) = (-1./overlap_cor(index(i-1),:)+1./overlap_cor(index(i),:))./(1./overlap_cor(index(i-1),:))*100;
        plot(rel_diff_all3(index(i),:),range,'color',colorvec(i,:),'displayname',datestr(time(index(i))));
        xlabel_rel_diff_all3 = {'Relative difference';'With last well-trusted overlap function'};
    end
    
    
    subplot(2,3,4)
    
    %recalculate relative difference with overlap correction of closest temperature
    index_all = 1:length(index);
    index_all_short = index_all(~(i==(1:length(index))));
    [~,index_min]= min(abs(temp_mean(index(index_all_short))-temp_mean(index(i))));
    rel_diff_all4(index(i),:) = (-1./overlap_cor(index(index_all_short(index_min)),:)+1./overlap_cor(index(i),:))./(1./overlap_cor(index(index_all_short(index_min)),:))*100;
    xlabel_rel_diff_all4 = {'Relative difference';'With well-trusted overlap function of closest Temperature'};
    plot(rel_diff_all4(index(i),:),range,'color',colorvec(i,:),'displayname',datestr(time(index(i))));  

    
    subplot(2,3,5)
    
    %recalculate relative difference with overlap correction of closest time
    index_all = 1:length(index);
    index_all_short = index_all(~(i==(1:length(index))));
    [~,index_min]= min(abs(time(index(index_all_short))-time(index(i))));
    rel_diff_all5(index(i),:) = (-1./overlap_cor(index(index_all_short(index_min)),:)+1./overlap_cor(index(i),:))./(1./overlap_cor(index(index_all_short(index_min)),:))*100;
    xlabel_rel_diff_all5 = {'Relative difference';'With well-trusted overlap function of closest time'};
    plot(rel_diff_all5(index(i),:),range,'color',colorvec(i,:),'displayname',datestr(time(index(i))));  
    
    
    subplot(2,3,6)
    
    %recalculate relative difference with corrected overlap of specific date
    i_dateofinterest = find(time==datenum(2014,06,16));
    if isempty(i_dateofinterest)
        error('date of interest not found')
    end
    rel_diff_all6(index(i),:) = (-1./overlap_cor(i_dateofinterest,:)+1./overlap_cor(index(i),:))./(1./overlap_cor(i_dateofinterest,:))*100;
    xlabel_rel_diff_all6 = {'Relative difference';['With well-trusted overlap of ' datestr(time(i_dateofinterest))]};
    plot(rel_diff_all6(index(i),:),range,'color',colorvec(i,:),'displayname',datestr(time(index(i))));  
    
end


subplot(2,3,1)
hold on;
plot(median(rel_diff_all1(index,:)),range,'-k','linewidth',2)
plot(prctile(rel_diff_all1(index,:),25),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
plot(prctile(rel_diff_all1(index,:),75),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
ylim(ylims);
grid on;box on;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all1);
hold on;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
plot(xlims,max(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
RMSE=sqrt(1/numel(rel_diff_all1(index,index_range_for_stats)) *nansum(nansum(rel_diff_all1(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all1(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all1(index,index_range_for_stats),75)-prctile(rel_diff_all1(index,index_range_for_stats),25));
title(['RMSE=' num2str(RMSE) ',MEANmedian=' num2str(MEANmedian) ',MEANiqr=' num2str(MEANiqr)]);
colormap('jet');
caxis([15 40]);

subplot(2,3,2)
plot(median(rel_diff_all2(index,:)),range,'-k','linewidth',2)
plot(prctile(rel_diff_all2(index,:),25),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
plot(prctile(rel_diff_all2(index,:),75),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
ylim(ylims);
grid on;box on;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all2)
hold on;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
plot(xlims,max(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
RMSE=sqrt(1/numel(rel_diff_all2(index,index_range_for_stats)) *nansum(nansum(rel_diff_all2(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all2(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all2(index,index_range_for_stats),75)-prctile(rel_diff_all2(index,index_range_for_stats),25));
title(['RMSE=' num2str(RMSE) ',MEANmedian=' num2str(MEANmedian) ',MEANiqr=' num2str(MEANiqr)]);
colormap('jet');
caxis([15 40]);

subplot(2,3,3)
plot(median(rel_diff_all3(index,:)),range,'-k','linewidth',2)
plot(prctile(rel_diff_all3(index,:),25),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
plot(prctile(rel_diff_all3(index,:),75),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
ylim(ylims);
grid on;box on;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all3)
hold on;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
plot(xlims,max(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
RMSE=sqrt(1/numel(rel_diff_all3(index,index_range_for_stats)) *nansum(nansum(rel_diff_all3(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all3(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all3(index,index_range_for_stats),75)-prctile(rel_diff_all3(index,index_range_for_stats),25));
title(['RMSE=' num2str(RMSE) ',MEANmedian=' num2str(MEANmedian) ',MEANiqr=' num2str(MEANiqr)]);
colormap('jet');
caxis([15 40]);

subplot(2,3,4)
plot(median(rel_diff_all4(index,:)),range,'-k','linewidth',2)
plot(prctile(rel_diff_all4(index,:),25),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
plot(prctile(rel_diff_all4(index,:),75),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
ylim(ylims);
grid on;box on;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all4)
hold on;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
plot(xlims,max(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
RMSE=sqrt(1/numel(rel_diff_all4(index,index_range_for_stats)) *nansum(nansum(rel_diff_all4(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all4(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all4(index,index_range_for_stats),75)-prctile(rel_diff_all4(index,index_range_for_stats),25));
title(['RMSE=' num2str(RMSE) ',MEANmedian=' num2str(MEANmedian) ',MEANiqr=' num2str(MEANiqr)]);
colormap('jet');
caxis([15 40]);

subplot(2,3,5)
plot(median(rel_diff_all5(index,:)),range,'-k','linewidth',2)
plot(prctile(rel_diff_all5(index,:),25),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
plot(prctile(rel_diff_all5(index,:),75),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
ylim(ylims);
grid on;box on;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all5)
hold on;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
plot(xlims,max(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
RMSE=sqrt(1/numel(rel_diff_all5(index,index_range_for_stats)) *nansum(nansum(rel_diff_all5(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all5(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all5(index,index_range_for_stats),75)-prctile(rel_diff_all5(index,index_range_for_stats),25));
title(['RMSE=' num2str(RMSE) ',MEANmedian=' num2str(MEANmedian) ',MEANiqr=' num2str(MEANiqr)]);
colormap('jet');
caxis([15 40]);

subplot(2,3,6)
plot(median(rel_diff_all6(index,:)),range,'-k','linewidth',2)
plot(prctile(rel_diff_all6(index,:),25),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
plot(prctile(rel_diff_all6(index,:),75),range,'REPLACE_WITH_DASH_DASHk','linewidth',2)
ylim(ylims);
grid on;box on;
ylabel(ylabel_str)
xlim(xlims)
xlabel(xlabel_rel_diff_all6)
hold on;
plot(xlims,min(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
plot(xlims,max(range(index_range_for_stats))*ones(1,2),'REPLACE_WITH_DASH_DASHk');
RMSE=sqrt(1/numel(rel_diff_all6(index,index_range_for_stats)) *nansum(nansum(rel_diff_all6(:,index_range_for_stats).^2,2)));
MEANmedian=mean(median(rel_diff_all6(index,index_range_for_stats)));
MEANiqr=mean(prctile(rel_diff_all6(index,index_range_for_stats),75)-prctile(rel_diff_all6(index,index_range_for_stats),25));
title(['RMSE=' num2str(RMSE) ',MEANmedian=' num2str(MEANmedian) ',MEANiqr=' num2str(MEANiqr)]);
colormap('jet');
caxis([15 40]);

% return


%% Load test data

% date = '20130417';
date = '20140614';

[chm,chminfo] = get_chm15k_from_files('pay',[date,'000000'],datestr(datenum(date,'yyyymmdd')+1,'yyyymmddHHMMSS'),folder_ncdata);
% [chm,chminfo]=readcorrectlyncfile3('pay',date,folder_ncdata);

RCS_raw = chm.beta_raw;
RCS_dailycorrection = chm.beta_raw./repmat(overlap_cor(find(time==datenum(date,'yyyymmdd')),:)',1,size(chm.beta_raw,2)).*repmat(overlap_ref,1,size(chm.beta_raw,2));

% Calc Grad
grad_raw = NaN(size(RCS_raw));
for j=1:length(chm.time)
    grad_raw(:,j) = 1/(2*chm.range_gate)*conv(RCS_raw(:,j),[1 0 -1],'same');
end
grad_dailycorrection = NaN(size(RCS_dailycorrection));
for j=1:length(chm.time)
    grad_dailycorrection(:,j) = 1/(2*chm.range_gate)*conv(RCS_dailycorrection(:,j),[1 0 -1],'same');
end

% plot internal temperature
figure;
plot(chm.time,chm.temp_int-273.15);datetick;ylim([15 40]);box on;grid on;
xlabel('Time [UT]');ylabel('Internal Temperature [°C]');title(['pay ' date]);

%% calculate RCS and grad(RCS) with the model

%correct according to T

ind_last_as_reference = find(b>0 & range <range(find(overlap_ref<0.01,1,'last')),1,'last');
if ~isempty(ind_last_as_reference)
    a(range<=range(ind_last_as_reference)) = 0;
    c(range<=range(ind_last_as_reference)) = 0;
    b(range<=range(ind_last_as_reference)) = 0;
end

ov_rec_all = NaN(size(RCS_raw));
for i=1:find(chm.range<=1200,1,'last')
    rel_diff = polyval([a(i),b(i),c(i)],chm.temp_int-273.15);
    ov_rec_all(i,:) = 1./ (rel_diff/100/overlap_ref(i) + 1./overlap_ref(i));
end
ov_rec_all(find(chm.range<=1200,1,'last')+1:end,:) = repmat(overlap_ref(find(chm.range<=1200,1,'last')+1:end),1,size(RCS_raw,2));

RCS_corr = RCS_raw./ov_rec_all.*repmat(overlap_ref,1,size(RCS_raw,2));

% Calc Grad
grad_corr = NaN(size(RCS_corr));
for j=1:length(chm.time)
    grad_corr(:,j) = 1/(2*chm.range_gate)*conv(RCS_corr(:,j),[1 0 -1],'same');
end

%% Calculate PBL with simple code

[gradients_raw,xtime] = simplePBLdetection(chm,overlap_ref,overlap_ref);
[gradients_dailycorrection,xtime] = simplePBLdetection(chm,overlap_ref,overlap_cor(find(time==datenum(date,'yyyymmdd')),:)');
[gradients_corr,xtime] = simplePBLdetection(chm,overlap_ref,ov_rec_all);

% Plot PBL
figure;

subplot(3,1,1);
gradients = gradients_raw;
correction_type = 'raw';
list_plots = [];
list_legends = {};
hold on;
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(5,:),'.','color',0.5*ones(1,3));
list_legends{end+1} = 'clouds';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(4,:),'.k');
list_legends{end+1} = '1. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(3,:),'.g');
list_legends{end+1} = '2. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(2,:),'.y');
list_legends{end+1} = '3. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(1,:),'.r');
list_legends{end+1} = 'min. gradient';
legend(list_plots,list_legends,'location','eastoutside');
ylim([0 2500]);
xlim([datenum(date,'yyyymmdd') datenum(date,'yyyymmdd')+1]);
set(gca,'xtick',datenum(date,'yyyymmdd'):4/24:datenum(date,'yyyymmdd')+1);
datetick('x','HH:MM','keepticks','keeplimits');
title(['pay ' date ' - ' correction_type]);
grid on;box on;
xlabel('Time [UT]');
ylabel('Range [m]');

subplot(3,1,2);
gradients = gradients_dailycorrection;
correction_type = 'daily correction';
list_plots = [];
list_legends = {};
hold on;
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(5,:),'.','color',0.5*ones(1,3));
list_legends{end+1} = 'clouds';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(4,:),'.k');
list_legends{end+1} = '1. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(3,:),'.g');
list_legends{end+1} = '2. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(2,:),'.y');
list_legends{end+1} = '3. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(1,:),'.r');
list_legends{end+1} = 'min. gradient';
legend(list_plots,list_legends,'location','eastoutside');
ylim([0 2500]);
xlim([datenum(date,'yyyymmdd') datenum(date,'yyyymmdd')+1]);
set(gca,'xtick',datenum(date,'yyyymmdd'):4/24:datenum(date,'yyyymmdd')+1);
datetick('x','HH:MM','keepticks','keeplimits');
title(['pay ' date ' - ' correction_type]);
grid on;box on;
xlabel('Time [UT]');
ylabel('Range [m]');

subplot(3,1,3);
gradients = gradients_corr;
correction_type = 'model';
list_plots = [];
list_legends = {};
hold on;
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(5,:),'.','color',0.5*ones(1,3));
list_legends{end+1} = 'clouds';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(4,:),'.k');
list_legends{end+1} = '1. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(3,:),'.g');
list_legends{end+1} = '2. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(2,:),'.y');
list_legends{end+1} = '3. strongest gradient';
list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime,gradients(1,:),'.r');
list_legends{end+1} = 'min. gradient';
legend(list_plots,list_legends,'location','eastoutside');
ylim([0 2500]);
xlim([datenum(date,'yyyymmdd') datenum(date,'yyyymmdd')+1]);
set(gca,'xtick',datenum(date,'yyyymmdd'):4/24:datenum(date,'yyyymmdd')+1);
datetick('x','HH:MM','keepticks','keeplimits');
title(['pay ' date ' - ' correction_type]);
grid on;box on;
xlabel('Time [UT]');
ylabel('Range [m]');

%% Plot

RCS_list = {RCS_raw,RCS_dailycorrection,RCS_corr};
grad_list = {grad_raw,grad_dailycorrection,grad_corr};
gradients_list = {gradients_raw,gradients_dailycorrection,gradients_corr};
correction_type_list = {'raw','daily correction','model correction'};

for k=1:length(RCS_list)
    RCS = RCS_list{k};
    grad = grad_list{k};
    gradients = gradients_list{k};
    title_str = [info.chm '/' info.tub '/' station ' - ' date ' - ' correction_type_list{k}];


    offset = datenum(2000,1,1)-1;
    disp_clouds = true;
    disp_pbl = true;
    % Choose pcolor parameters
    dxticks = 4;%in hours
    fz = 14;% FontSize
    ylims = [0 2500];
    yticks = ylims(1):100:ylims(2);
    clims = [4.5 6];
    clims_grad = [-1000 1000];
    % load('ypcmap2','cmap');
    
    figure
    
    handles.axes_pcolor_RCS = subplot(2,1,1);
    handles.surface_pcolor_RCS = pcolor(chm.time-offset,chm.range,log10(abs(RCS)));
    xlims = [floor(chm.time(1))-offset, ceil(chm.time(end))-offset];
    xticks = xlims(1)-mod(mod(xlims(1),1)*24,dxticks)/24:dxticks/24:xlims(2);
    set(gca,'XLim',xlims,'XTick',xticks,'XMinorTick','on');
    set(gca,'YLim',ylims,'YTick',yticks,'YMinorTick','on');
    grid on;
    set(gca,'Layer','top');
    datetick('x','HH:MM','keepticks','keeplimits');
    shading flat
    caxis(clims)
    %     colormap(cmap)
    hc = colorbar;
    xlabel('Time UT [h]','FontSize',fz);
    ylabel(hc,'log10(abs(beta\_raw))','FontSize',fz);
    ylabel('Range (m)','FontSize',fz);
    % daspect(aspect_ratio);
    list_plots = [];
    list_legends = {};
    
    if(disp_pbl)
        %     for j=1:3
        %         pblh = chm.pbl(j,:);
        %         pblh(pblh <= chm.cho) = NaN;
        %         hpbl = line(chm.time-offset,pblh-chm.cho,'LineStyle','none','Marker','.','Color','k');
        %     end
        %     list_plots(end+1) = hpbl;
        %     list_legends{end+1} = 'PBL';
        hold on;
        list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime-offset,gradients(4,:),'.k','MarkerSize',16);
        list_legends{end+1} = '1. strongest gradient';
        list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime-offset,gradients(3,:),'.m','MarkerSize',16);
        list_legends{end+1} = '2. strongest gradient';
        list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime-offset,gradients(2,:),'.b','MarkerSize',16);
        list_legends{end+1} = '3. strongest gradient';
        list_plots(end+1) = plot(datenum(date,'yyyymmdd')+xtime-offset,gradients(1,:),'.r','MarkerSize',16);
        list_legends{end+1} = 'min. gradient';
    end
    if(disp_clouds)
        for j=1:3
            cbh = chm.cbh(j,:);
            cbh(cbh <= chm.cho) = NaN;
            hcbh = line(chm.time-offset,cbh-chm.cho,'LineStyle','none','Marker','.','MarkerSize',16,'Color',[0.5 0.5 0.5]);
        end
        list_plots(end+1) = hcbh;
        list_legends{end+1} = 'CBH';
    end
    if ~isempty(list_plots)
        legend(list_plots,list_legends,'Orientation','horizontal');
    end
    set(gca,'FontSize',fz);
    
    title(title_str,'FontSize',fz);
    
    handles.axes_pcolor_grad = subplot(2,1,2);
    handles.surface_pcolor_grad = pcolor(chm.time-offset,chm.range,grad);
    xlims = [floor(chm.time(1))-offset, ceil(chm.time(end))-offset];
    xticks = xlims(1)-mod(mod(xlims(1),1)*24,dxticks)/24:dxticks/24:xlims(2);
    set(gca,'XLim',xlims,'XTick',xticks,'XMinorTick','on');
    set(gca,'YLim',ylims,'YTick',yticks,'YMinorTick','on');
    grid on;
    set(gca,'Layer','top');
    datetick('x','HH:MM','keepticks','keeplimits');
    shading flat
    caxis(clims_grad)
    colormap(jet)
    hc = colorbar;
    xlabel('Time UT [h]','FontSize',fz);
    ylabel(hc,'grad(beta\_raw)','FontSize',fz);
    ylabel('Range (m)','FontSize',fz);
    % daspect(aspect_ratio);
    set(gca,'FontSize',fz);
    
    set(gcf,'PaperPositionMode','auto');

end


##### SOURCE END #####
--></body></html>